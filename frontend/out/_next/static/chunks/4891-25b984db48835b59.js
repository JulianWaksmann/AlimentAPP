"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4891],{15239:(e,a,r)=>{r.d(a,{default:()=>n.a});var t=r(54652),n=r.n(t)},20063:(e,a,r)=>{var t=r(47260);r.o(t,"usePathname")&&r.d(a,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}})},51730:(e,a,r)=>{r.d(a,{default:()=>s});var t=r(95155);r(12115);var n=r(20063),i=r(84926),l=r(15239);let s=()=>{let e=(0,n.useRouter)();return(0,t.jsxs)("header",{className:"relative flex items-center justify-center py-3 text-center text-white",children:[(0,t.jsx)(l.default,{src:"/Banner.jpg",alt:"Banner",fill:!0,priority:!0,className:"object-cover "}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,t.jsx)("h4",{children:"El N\xfacleo de tu Empresa"})]}),(0,t.jsxs)("button",{onClick:()=>{e.push("/")},className:"absolute top-1/2 right-4 -translate-y-1/2 flex items-center gap-2 px-3 py-1.5 text-sm font-semibold bg-white text-primary rounded-md hover:bg-gray-200 transition","aria-label":"Cerrar sesi\xf3n",children:[(0,t.jsx)(i.A,{size:16}),(0,t.jsx)("span",{})]})]})}},54652:(e,a,r)=>{Object.defineProperty(a,"__esModule",{value:!0}),!function(e,a){for(var r in a)Object.defineProperty(e,r,{enumerable:!0,get:a[r]})}(a,{default:function(){return d},getImageProps:function(){return s}});let t=r(28140),n=r(75040),i=r(81356),l=t._(r(71124));function s(e){let{props:a}=(0,n.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(a))void 0===r&&delete a[e];return{props:a}}let d=i.Image},71847:(e,a,r)=>{r.d(a,{A:()=>d});var t=r(12115);let n=e=>{let a=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,r)=>r?r.toUpperCase():a.toLowerCase());return a.charAt(0).toUpperCase()+a.slice(1)},i=function(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return a.filter((e,a,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===a).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,t.forwardRef)((e,a)=>{let{color:r="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:d,className:o="",children:c,iconNode:u,...m}=e;return(0,t.createElement)("svg",{ref:a,...l,width:n,height:n,stroke:r,strokeWidth:d?24*Number(s)/Number(n):s,className:i("lucide",o),...!c&&!(e=>{for(let a in e)if(a.startsWith("aria-")||"role"===a||"title"===a)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[a,r]=e;return(0,t.createElement)(a,r)}),...Array.isArray(c)?c:[c]])}),d=(e,a)=>{let r=(0,t.forwardRef)((r,l)=>{let{className:d,...o}=r;return(0,t.createElement)(s,{ref:l,iconNode:a,className:i("lucide-".concat(n(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),d),...o})});return r.displayName=n(e),r}},80974:(e,a,r)=>{r.d(a,{A:()=>l});var t=r(95155),n=r(12115),i=r(96440);let l=e=>{var a;let{estadoOP:r,cambiarEstado:l,estadoNuevo:d}=e,[o,c]=(0,n.useState)([]),[u,m]=(0,n.useState)(!0),[p,h]=(0,n.useState)(null),[x,g]=(0,n.useState)(!1),[_,f]=(0,n.useState)(null),[b,j]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!1),[N,w]=(0,n.useState)(null),C=(0,n.useMemo)(()=>(null==d?void 0:d.trim())?d:"planificada"===r.toLowerCase()?"en_progreso":"completada",[r,d]),k=async()=>{m(!0),h(null);try{let e=(await (0,i.Ec)(r)).map(e=>{var a,r,t;return{id_linea_produccion:null!=(a=e.id_linea_produccion)?a:0,nombre_linea_produccion:null!=(r=e.nombre_linea_produccion)?r:"Sin nombre",tandas_de_produccion:(null!=(t=e.tandas_de_produccion)?t:[]).map(e=>{var a,r,t,n,i,l,s,d,o,c;return{id_tanda_produccion:null!=(a=e.id_tanda_produccion)?a:0,id_orden_produccion:null!=(r=e.id_orden_produccion)?r:null,nombre_producto:null!=(t=e.nombre_producto)?t:null,cantidad_kg_tanda:null!=(n=e.cantidad_kg_tanda)?n:null,estado_tanda_produccion:null!=(i=e.estado_tanda_produccion)?i:null,nombre_cliente:null!=(l=e.nombre_cliente)?l:null,apellido_cliente:null!=(s=e.apellido_cliente)?s:null,fecha_creacion_orden_venta:null!=(d=e.fecha_creacion_orden_venta)?d:null,fecha_entrega_solicitada_orden_venta:null!=(o=e.fecha_entrega_solicitada_orden_venta)?o:null,materias_primas_requeridas:(null!=(c=e.materias_primas_requeridas)?c:[]).map(e=>({codigo_lote:e.codigo_lote,id_materia_prima:e.id_materia_prima,nombre_materia_prima:e.nombre_materia_prima,id_lote_materia_prima:e.id_lote_materia_prima,cantidad_materia_prima:Number(e.cantidad_materia_prima),unidad_medida_materia_prima:e.unidad_medida_materia_prima}))}})}});console.log(e),c(e)}catch(e){h(e instanceof Error?e.message:"Error al obtener tandas")}finally{m(!1)}};(0,n.useEffect)(()=>{k()},[r]);let E=async()=>{if(!N||0===N.ids.length)return void j(!1);try{v(!0),await l(N.ids),await k(),window.location.reload()}catch(e){console.error(e)}finally{v(!1),j(!1),w(null)}};return u?(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)("div",{className:"animate-pulse grid gap-4 sm:grid-cols-2",children:[void 0,void 0,void 0,void 0].map((e,a)=>(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-4",children:[(0,t.jsx)("div",{className:"h-5 w-2/3 rounded bg-gray-200"}),(0,t.jsx)("div",{className:"mt-3 h-4 w-1/2 rounded bg-gray-200"}),(0,t.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,t.jsx)("div",{className:"h-10 rounded bg-gray-100"}),(0,t.jsx)("div",{className:"h-10 rounded bg-gray-100"})]})]},a))})}):p?(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)("div",{className:"rounded-md border border-red-200 bg-red-50 p-3 text-red-700",children:p})}):0===o.length?(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-6 text-center text-gray-600",children:["No hay tandas en estado “",r,"”."]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"p-4 grid gap-4 md:gap-6 grid-cols-1 md:grid-cols-2",children:o.map((e,a)=>{var n,i,l;let s=null!=(n=e.id_linea_produccion)?n:a,d=null!=(i=e.nombre_linea_produccion)?i:"L\xednea #".concat(s),o=null!=(l=e.tandas_de_produccion)?l:[],c=o.map(e=>e.id_tanda_produccion).filter(e=>"number"==typeof e);return(0,t.jsxs)("article",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[(0,t.jsxs)("header",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between p-4 border-b border-gray-100",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:d}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[o.length," tandas \xb7 estado actual: ",r]})]}),(0,t.jsxs)("button",{className:"inline-flex items-center justify-center rounded-lg px-4 py-2 text-sm font-medium text-white transition ".concat(0===c.length?"bg-gray-300 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"),disabled:0===c.length,onClick:()=>(e=>{var a,r,t;let n=(null!=(a=e.tandas_de_produccion)?a:[]).map(e=>e.id_tanda_produccion).filter(e=>"number"==typeof e);w({id_linea:null!=(r=e.id_linea_produccion)?r:null,nombre:null!=(t=e.nombre_linea_produccion)?t:null,ids:n}),j(!0)})(e),title:0===c.length?"No hay tandas para actualizar":"Cambiar a ".concat(C),children:["Cambiar a “",C.replaceAll("_"," "),"”"]})]}),(0,t.jsx)("ul",{className:"divide-y divide-gray-100",children:o.map((e,a)=>{var r,n,i,l,d,o,c;let u="".concat(s,"-").concat(null!=(r=e.id_tanda_produccion)?r:a);return(0,t.jsxs)("li",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Orden #",null!=(n=e.id_orden_produccion)?n:"—"]}),(0,t.jsx)("div",{className:"text-base font-medium text-gray-800",children:null!=(i=e.nombre_producto)?i:"Producto"}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[null!=(l=e.cantidad_kg_tanda)?l:"—"," kg \xb7"," ",null!=(d=e.estado_tanda_produccion)?d:"—"]}),(e.nombre_cliente||e.apellido_cliente)&&(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Cliente: ",e.nombre_cliente," ",e.apellido_cliente]})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,t.jsxs)("div",{children:["Entrega solicitada:"," ",e.fecha_entrega_solicitada_orden_venta?new Date(e.fecha_entrega_solicitada_orden_venta).toLocaleDateString():"—"]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{className:"rounded p-1 bg-primary-softer",onClick:()=>{g(!0),f(e)},children:"Ver Materia Prima"})})]})]}),x&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>g(!1),children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50 rounded-t-xl",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-800",children:"Materias Primas Requeridas"}),(0,t.jsx)("button",{className:"p-2 rounded-lg bg-red-100 hover:bg-red-200 text-red-700 transition",onClick:()=>g(!1),"aria-label":"Cerrar",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,t.jsx)("div",{className:"overflow-y-auto flex-1 p-4",children:0===(null!=(o=null==_?void 0:_.materias_primas_requeridas)?o:[]).length?(0,t.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No hay materias primas registradas"}):(0,t.jsx)("ul",{className:"divide-y divide-gray-200",children:null==_?void 0:_.materias_primas_requeridas.map(e=>(0,t.jsx)("li",{className:"py-2 first:pt-0 last:pb-0 hover:bg-gray-50 rounded-lg px-3 transition",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h5",{className:"font-medium text-gray-900 truncate",children:e.nombre_materia_prima}),(0,t.jsx)("div",{className:"mt-1 flex flex-wrap gap-2 text-xs text-gray-600",children:(0,t.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-blue-100 text-blue-700",children:["Lote: ",e.codigo_lote]})})]}),(0,t.jsxs)("div",{className:"flex-shrink-0 text-right",children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-indigo-600",children:e.cantidad_materia_prima}),(0,t.jsx)("div",{className:"text-xs text-gray-500 uppercase",children:e.unidad_medida_materia_prima})]})]})},"".concat(e.id_materia_prima,"-").concat(e.id_lote_materia_prima)))})}),(null!=(c=null==_?void 0:_.materias_primas_requeridas)?c:[]).length>0&&(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Total de materias primas:"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:null==_?void 0:_.materias_primas_requeridas.length})]})})]})})]},u)})})]},s)})}),(0,t.jsx)(s,{open:b,loading:y,onCancel:()=>{y||(j(!1),w(null))},onConfirm:E,title:"Confirmar cambio de estado",children:N&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{children:["Vas a cambiar ",N.ids.length," tanda(s) de la l\xednea"," ",(0,t.jsx)("strong",{children:N.nombre||"#".concat(null!=(a=N.id_linea)?a:"—")})," ","a estado “",C,"”."]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"\xbfConfirm\xe1s la acci\xf3n?"})]})})]})},s=e=>{let{open:a,loading:r,title:n,onConfirm:i,onCancel:l,children:s}=e;return a?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:r?void 0:l}),(0,t.jsxs)("div",{className:"relative w-full sm:max-w-md sm:w-auto bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-5 sm:p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-800",children:n||"Confirmaci\xf3n"}),(0,t.jsx)("div",{className:"mt-3 text-gray-700",children:s}),(0,t.jsxs)("div",{className:"mt-5 flex gap-3 justify-end",children:[(0,t.jsx)("button",{className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-60",onClick:l,disabled:r,children:"Cancelar"}),(0,t.jsx)("button",{className:"px-4 py-2 rounded-lg text-white ".concat(r?"bg-indigo-400":"bg-indigo-600 hover:bg-indigo-700"),onClick:i,disabled:r,children:r?"Aplicando...":"Confirmar"})]})]})]}):null}},84926:(e,a,r)=>{r.d(a,{A:()=>t});let t=(0,r(71847).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},96440:(e,a,r)=>{r.d(a,{Ec:()=>n,N0:()=>l,sI:()=>s,tv:()=>d,w_:()=>i});let t="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function n(e){let a=await fetch("".concat(t,"/tanda-produccion/post-obtener-tanda-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!a.ok)throw Error("Error fetching tandas sugeridas");let r=await a.json();return console.log(r),r.lineas_produccion}async function i(e,a){let r={id_tandas:e,estado:a};if(console.log(r),console.log("actualizar ot "+e+" a estado: "+a),!(await fetch("".concat(t,"/tanda-produccion/post-update-tandas-produccion-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw Error("Error updating tanda produccion")}async function l(){let e=await fetch("".concat(t,"/tanda-produccion/get-all-ordenes-produccion-aceptadas-por-linea-produccion"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error generating tanda");let a=await e.json();return console.log(a),a.lineas_produccion}async function s(e){console.log("Crear Tanda Produccion Manual: ",JSON.stringify({id_linea_produccion:e.id_linea_produccion,ordenes_produccion:e.ordenes_produccion}));let a=await fetch("".concat(t,"/tanda-produccion/post-crear-tandas-produccion-manual"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw console.log("Error creating tanda produccion manual:",e),Error(e.error||"Error creating tanda produccion manual")}return a.json()}async function d(){try{let e=await fetch("".concat(t,"/orden-produccion/planificador_op_daily"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let a=await e.json();throw Error(a.error||"Error fetching planificacion data")}return await e.json()}catch(e){throw console.log("error general: "+e),e}}}}]);