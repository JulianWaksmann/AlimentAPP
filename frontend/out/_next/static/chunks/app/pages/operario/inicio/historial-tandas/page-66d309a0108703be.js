(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9799],{1208:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>o});var r=t(95155),s=t(96440),n=t(12115);let i=e=>e?new Date(e).toLocaleString():"—";function d(e){let{tandas:a,className:t}=e,[s,d]=(0,n.useState)({}),[c,o]=(0,n.useState)({}),[l,m]=(0,n.useState)(a||[]),p=new Date;return((0,n.useEffect)(()=>{m(a||[])},[a]),l&&0!==l.length)?(0,r.jsx)("div",{className:"space-y-4 p-4 ".concat(null!=t?t:""),children:l.map((e,a)=>{var t,n;let l=null!=(t=e.id_linea_produccion)?t:a,m=null!=(n=e.tandas_de_produccion)?n:[];return(0,r.jsxs)("article",{className:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200",children:[(0,r.jsxs)("header",{className:"flex items-center justify-between p-3 sm:p-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-base font-semibold text-gray-800",children:["L\xednea de Producci\xf3n #",l," "]}),e.nombre_linea_produccion?(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["\xb7 ",e.nombre_linea_produccion]}):null,"completada"===e.tandas_de_produccion[0].estado_tanda_produccion?(0,r.jsx)("span",{className:"text-sm text-green-500",children:"\xb7 Completada"}):(0,r.jsx)("span",{className:"text-sm text-orange-500",children:"\xb7 En proceso"}),m.map(e=>{var a,t,s;return(0,r.jsx)("div",{className:"text-sm text-gray-500",children:(0,r.jsxs)("div",{children:["Orden #",e.id_orden_produccion," -"," ",null!=(t=e.nombre_producto)?t:"Producto #".concat(null!=(a=e.id_producto)?a:"—")," ","\xb7 ",null!=(s=e.cantidad_kg_tanda)?s:"—"," kg"]})},e.id_orden_produccion)})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("button",{onClick:()=>d(e=>({...e,[l]:!e[l]})),"aria-expanded":!!s[l],className:"text-sm px-3 py-1 rounded-md bg-primary/10 text-primary hover:bg-primary/20",children:s[l]?"Ocultar":"Ver"})})]}),s[l]&&(0,r.jsxs)("div",{className:"divide-y",children:[m.map(e=>{var a,t,s,n,d,l,m,x,u,h,_,g,j;let y=null!=(t=e.id_orden_produccion)?t:Math.random();return(0,r.jsxs)("div",{className:"p-3 sm:p-4",children:[(0,r.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:null!=(n=e.nombre_producto)?n:"Producto #".concat(null!=(s=e.id_producto)?s:"—")}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Cliente: ",null!=(d=e.nombre_cliente)?d:"—"," ",null!=(l=e.apellido_cliente)?l:""]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[null!=(m=e.cantidad_kg_tanda)?m:"—"," kg"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Sec: ",null!=(x=e.secuencia_en_linea)?x:"—"]})]})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:[(0,r.jsxs)("div",{children:["Fecha creaci\xf3n de orden de producci\xf3n:"," ",i(e.fecha_creacion_orden_produccion)]}),(0,r.jsxs)("div",{children:["Fecha de entrega solicitada:"," ",i(e.fecha_entrega_solicitada_orden_venta)]}),(0,r.jsxs)("div",{className:"mt-1",children:["Estado tanda:"," ",(0,r.jsx)("span",{className:"font-medium ".concat(p>new Date(null!=(u=e.fecha_entrega_solicitada_orden_venta)?u:"")?"text-red-600":"text-green-600"),children:p>new Date(null!=(h=e.fecha_entrega_solicitada_orden_venta)?h:"")?"Retrasada":"A tiempo"})]})]})]})}),(0,r.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,r.jsx)("button",{onClick:()=>o(e=>({...e,[y]:!e[y]})),className:"text-sm px-3 py-1 rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200",children:c[y]?"Ocultar detalle":"Ver detalle"})}),c[y]&&(0,r.jsxs)("div",{className:"mt-3 bg-gray-50 p-3 rounded-md text-sm text-gray-700",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Id Orden:"})," ",e.id_orden_produccion]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Cantidad producto:"})," ",null!=(_=e.cantidad_producto)?_:"—"," bultos"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Fecha entrega solicitada:"})," ",i(e.fecha_entrega_solicitada_orden_venta)]})]}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsxs)("details",{className:"bg-white border rounded-md",children:[(0,r.jsxs)("summary",{className:"px-3 py-2 cursor-pointer flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Materias primas requeridas"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[null!=(g=null==(a=e.materias_primas_requeridas)?void 0:a.length)?g:0," ","items"]})]}),(0,r.jsxs)("div",{className:"p-3 space-y-2",children:[(null!=(j=e.materias_primas_requeridas)?j:[]).map(e=>{var a,t;return(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.nombre_materia_prima}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.codigo_lote})]}),(0,r.jsxs)("div",{className:"text-right text-sm text-gray-700",children:[e.cantidad_materia_prima," ",null!=(a=e.unidad_medida_materia_prima)?a:""]})]},null!=(t=e.id_lote_materia_prima)?t:e.codigo_lote)}),(!e.materias_primas_requeridas||0===e.materias_primas_requeridas.length)&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"No hay materias primas asignadas"})]})]})})]})]},y)}),0===m.length&&(0,r.jsx)("div",{className:"p-4 text-center text-sm text-gray-500",children:"No hay \xf3rdenes en esta tanda"})]})]},l)})}):(0,r.jsx)("div",{className:"p-4 text-center text-sm text-gray-500",children:"No hay tandas para mostrar"})}var c=t(51730);let o=()=>{let[e,a]=(0,n.useState)([]);return(0,n.useEffect)(()=>{(async()=>{a([...await (0,s.Ec)("en_progreso"),...await (0,s.Ec)("completada")])})()},[]),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.A,{}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center pt-4 text-primary ",children:"Historial de Tandas"}),(0,r.jsx)(d,{tandas:e})]})}},38999:(e,a,t)=>{Promise.resolve().then(t.bind(t,1208))},51730:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});var r=t(95155);t(12115);let s=()=>(0,r.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,r.jsx)("h4",{children:"Gestion de Empresas"})]})},96440:(e,a,t)=>{"use strict";t.d(a,{Ec:()=>s,N0:()=>i,sI:()=>d,tv:()=>c,w_:()=>n});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function s(e){let a=await fetch("".concat(r,"/tanda-produccion/post-obtener-tanda-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!a.ok)throw Error("Error fetching tandas sugeridas");let t=await a.json();return console.log(t),t.lineas_produccion}async function n(e,a){if(console.log("actualizar ot "+e+" a estado: "+a),console.log("actualizar ot "+e+" a estado: "+a),!(await fetch("".concat(r,"/tanda-produccion/post-update-tandas-produccion-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_tandas:e,estado:a})})).ok)throw Error("Error updating tanda produccion")}async function i(){let e=await fetch("".concat(r,"/tanda-produccion/get-all-ordenes-produccion-aceptadas-por-linea-produccion"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error generating tanda");let a=await e.json();return console.log(a),a.lineas_produccion}async function d(e){console.log("Crear Tanda Produccion Manual: ",JSON.stringify({id_linea_produccion:e.id_linea_produccion,ordenes_produccion:e.ordenes_produccion}));let a=await fetch("".concat(r,"/tanda-produccion/post-crear-tandas-produccion-manual"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw console.log("Error creating tanda produccion manual:",e),Error(e.error||"Error creating tanda produccion manual")}return a.json()}async function c(){try{let e=await fetch("".concat(r,"/orden-produccion/planificador_op_daily"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let a=await e.json();throw Error(a.error||"Error fetching planificacion data")}return await e.json()}catch(e){throw console.log("error general: "+e),e}}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=38999)),_N_E=e.O()}]);