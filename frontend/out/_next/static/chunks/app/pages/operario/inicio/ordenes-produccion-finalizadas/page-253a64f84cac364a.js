(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1730:(e,a,n)=>{"use strict";n.d(a,{A:()=>r});var o=n(5155);n(2115);let r=()=>(0,o.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center",children:[(0,o.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,o.jsx)("h4",{children:"Gestion de Empresas"})]})},2121:(e,a,n)=>{"use strict";n.d(a,{A:()=>s});var o=n(5155),r=n(2115);let s=e=>{let{ordenes:a,estadoSiguiente:n,onCambiarEstado:s}=e,[d,t]=(0,r.useState)(null),[c,i]=(0,r.useState)(null),[l,p]=(0,r.useState)(null),u=async e=>{i(e),await s(e),i(null),t(null)};return(0,o.jsx)("div",{className:"w-full  mx-auto p-2",children:0===a.length?(0,o.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No hay \xf3rdenes de trabajo pendientes"}):(0,o.jsx)("ul",{className:"space-y-3",children:a.map(e=>(0,o.jsxs)("li",{className:"bg-white rounded-lg shadow p-3 flex flex-col gap-2",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center",children:[(0,o.jsxs)("span",{className:"font-bold text-primary",children:["Orden #",e.id_orden_produccion]}),(0,o.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-gray-200 text-gray-700",children:e.estado_orden_produccion})]}),(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Cliente:"})," ",e.nombre_cliente," ",e.apellido_cliente]}),(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Producto:"})," ",e.nombre_producto," "]}),(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Cantidad:"})," ",e.cantidad_producto]}),(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Fecha creaci\xf3n de orden de producci\xf3n:"})," ",e.fecha_creacion_orden_produccion&&new Date(e.fecha_creacion_orden_produccion).getTime()>0?new Date(e.fecha_creacion_orden_produccion).toLocaleDateString():"-"]}),(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Fecha fin de orden de producci\xf3n:"})," ",e.fecha_fin_orden_produccion&&new Date(e.fecha_fin_orden_produccion).getTime()>0?new Date(e.fecha_fin_orden_produccion).toLocaleDateString():"-"]}),(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Fecha entrega del pedido:"})," ",e.fecha_entrega_solicitada_orden_venta&&new Date(e.fecha_entrega_solicitada_orden_venta).getTime()>0?new Date(e.fecha_entrega_solicitada_orden_venta).toLocaleDateString():"-"]}),(0,o.jsxs)("div",{className:"flex gap-2 mt-2",children:[n?(0,o.jsxs)("button",{className:"flex-1 bg-details text-black rounded px-2 py-1 text-xs",onClick:()=>t(e.id_orden_produccion),children:["Cambiar estado a ",n]}):null,(0,o.jsx)("button",{className:"flex-1 bg-blue-500 text-white rounded px-2 py-1 text-xs",onClick:()=>p(l===e.id_orden_produccion?null:e.id_orden_produccion),children:l===e.id_orden_produccion?"Ocultar materia prima":"Ver materia prima"})]}),e.materias_primas_requeridas.length>0&&l===e.id_orden_produccion&&(0,o.jsxs)("div",{className:"mt-2",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Materias primas requeridas:"}),(0,o.jsx)("ul",{className:"list-disc list-inside text-sm mt-1",children:e.materias_primas_requeridas.map(e=>(0,o.jsxs)("li",{children:[e.nombre_materia_prima," - ",e.cantidad_materia_prima," ",e.unidad_medida_materia_prima," (Lote: ",e.codigo_lote,")"]},e.id_lote_materia_prima))})]}),d===e.id_orden_produccion&&(0,o.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,o.jsxs)("span",{className:"text-xs text-gray-700",children:["\xbfConfirmar cambio de estado a ",(0,o.jsx)("b",{children:n}),"?"]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{className:"flex-1 bg-details text-black rounded px-2 py-1 text-xs",disabled:c===e.id_orden_produccion,onClick:()=>u(e.id_orden_produccion),children:c===e.id_orden_produccion?"Cambiando...":"Confirmar"}),(0,o.jsx)("button",{className:"flex-1 bg-red-500  text-white rounded px-2 py-1 text-xs",onClick:()=>t(null),children:"Cancelar"})]})]})]},e.id_orden_produccion))})})}},6932:(e,a,n)=>{Promise.resolve().then(n.bind(n,9993))},8213:(e,a,n)=>{"use strict";n.d(a,{Bs:()=>r,K5:()=>s,Z7:()=>d});let o="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function r(){let e=await fetch("".concat(o,"/orden-produccion/orden-produccion-listaprd-enproceso-finalizada"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");let a=await e.json();return console.log(a.ordenes_produccion),Array.isArray(a.ordenes_produccion)?a.ordenes_produccion:[]}async function s(e,a){if(console.log("actualizar ot "+e+" a estado: "+a),!(await fetch("".concat(o,"/orden-produccion/update-orden-produccion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_orden_produccion:e,estado:a})})).ok)throw Error("Error updating orden de produccion")}async function d(e){console.log("fetch ordenes de produccion en estado: "+e);let a=await fetch("".concat(o,"/orden-produccion/listar-orden-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado_orden_produccion:e})});if(!a.ok)throw Error("Error fetching productos");let n=await a.json();return console.log(n),n.ordenes_produccion}},9993:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>c});var o=n(5155),r=n(2115),s=n(1730),d=n(8213),t=n(2121);let c=()=>{let[e,a]=(0,r.useState)([]);r.useEffect(()=>{(async()=>{try{let e=await (0,d.Z7)("finalizada");a(e)}catch(e){console.error("Error fetching data:",e)}})()},[]);let n=async e=>{try{await (0,d.K5)(e,""),a(a=>a.filter(a=>a.id_orden_produccion!==e))}catch(e){console.error("Error actualizando estado:",e)}};return(0,o.jsxs)("div",{children:[(0,o.jsx)(s.A,{}),(0,o.jsx)("div",{className:"text-lg font-bold mb-2",children:"Ordenes de Producci\xf3n Finalizadas"}),(0,o.jsx)(t.A,{ordenes:e,onCambiarEstado:n})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=6932)),_N_E=e.O()}]);