(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7194],{63:(e,r,t)=>{"use strict";var a=t(7260);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},520:(e,r,t)=>{Promise.resolve().then(t.bind(t,1155))},1155:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var a=t(5155),s=t(2115),n=t(1730),o=t(63);let i="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function c(e){let r=await fetch("".concat(i,"/recuperar-password/enviar-codigo-verificacion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.toLowerCase()})});return r.ok?{success:!0}:{success:!1,error:(await r.json()).error||"Error en login"}}async function l(e,r){let t=await fetch("".concat(i,"/recuperar-password/validar-codigo-verificacion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.toLowerCase(),codigo_verificacion:r})});return t.ok?{success:!0}:{success:!1,error:(await t.json()).error||"Error en login"}}async function u(e,r){let t=await fetch("".concat(i,"/recuperar-password/update-password-empleado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.toLowerCase(),nuevo_password:r})});return t.ok?{success:!0}:{success:!1,error:(await t.json()).error||"Error en login"}}let d=()=>{let[e,r]=(0,s.useState)(1),[t,i]=(0,s.useState)(""),[d,m]=(0,s.useState)(!1),[p,x]=(0,s.useState)(["","","","","",""]),[f,h]=(0,s.useState)(""),[b,g]=(0,s.useState)(""),[y,v]=(0,s.useState)(!1),[j,w]=(0,s.useState)(""),[N,C]=(0,s.useState)("error"),S=[(0,s.useRef)(null),(0,s.useRef)(null),(0,s.useRef)(null),(0,s.useRef)(null),(0,s.useRef)(null),(0,s.useRef)(null)],R=(0,o.useRouter)(),E=async e=>{e.preventDefault(),m(!0);let a=await c(t);m(!1),a.success?r(2):(w(a.error||"No se pudo enviar el c\xf3digo. Intenta nuevamente."),C("error"),v(!0))},k=async e=>{e.preventDefault(),m(!0);let a=await l(t,p.join(""));m(!1),a.success?r(3):(w(a.error||"C\xf3digo incorrecto. Intenta nuevamente."),C("error"),v(!0))},O=async e=>{if(e.preventDefault(),f!==b){w("Las contrase\xf1as no coinciden."),C("error"),v(!0);return}m(!0);let r=await u(t,f);m(!1),r.success?(w("Contrase\xf1a actualizada con \xe9xito."),C("success"),v(!0),setTimeout(()=>R.push("/"),1500)):(w(r.error||"No se pudo actualizar la contrase\xf1a. Intenta nuevamente."),C("error"),v(!0))};return(0,a.jsxs)("div",{children:[(0,a.jsx)(n.A,{}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4",children:[(0,a.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-lg shadow-md p-6 mt-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-center mb-4 text-primary",children:"Recuperar Credenciales"}),1===e&&(0,a.jsxs)("form",{onSubmit:E,className:"flex flex-col gap-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Correo electr\xf3nico"}),(0,a.jsx)("input",{type:"email",required:!0,value:t,onChange:e=>i(e.target.value),className:"rounded border px-3 py-2 w-full focus:outline-primary",placeholder:"tu@email.com"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"bg-primary text-white rounded py-2 font-semibold mt-2 hover:opacity-90 transition",children:d?"Enviando...":"Enviar c\xf3digo"})]}),2===e&&(0,a.jsxs)("form",{onSubmit:k,className:"flex flex-col gap-4 items-center",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-center",children:"Ingresa el c\xf3digo recibido"}),(0,a.jsx)("div",{className:"flex gap-2 justify-center mb-2",children:p.map((e,r)=>(0,a.jsx)("input",{ref:S[r],type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>((e,r)=>{var t,a;if(!/^[0-9]?$/.test(r))return;let s=[...p];s[e]=r,x(s),r&&e<5&&(null==(t=S[e+1].current)||t.focus()),!r&&e>0&&(null==(a=S[e-1].current)||a.focus())})(r,e.target.value),className:"w-10 h-10 text-center text-xl border rounded focus:outline-primary"},r))}),(0,a.jsx)("button",{type:"submit",disabled:d||p.some(e=>!e),className:"bg-primary text-white rounded py-2 font-semibold w-full hover:opacity-90 transition",children:d?"Verificando...":"Verificar c\xf3digo"})]}),3===e&&(0,a.jsxs)("form",{onSubmit:O,className:"flex flex-col gap-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Nueva contrase\xf1a"}),(0,a.jsx)("input",{type:"password",required:!0,value:f,onChange:e=>h(e.target.value),className:"rounded border px-3 py-2 w-full focus:outline-primary",placeholder:"Nueva contrase\xf1a"}),(0,a.jsx)("label",{className:"text-sm font-medium",children:"Repetir nueva contrase\xf1a"}),(0,a.jsx)("input",{type:"password",required:!0,value:b,onChange:e=>g(e.target.value),className:"rounded border px-3 py-2 w-full focus:outline-primary",placeholder:"Repetir nueva contrase\xf1a"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"bg-success text-white rounded py-2 font-semibold mt-2 hover:opacity-90 transition",children:d?"Actualizando...":"Actualizar contrase\xf1a"})]})]}),y&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,a.jsxs)("div",{className:"rounded-lg p-6 shadow-lg w-80 text-center ".concat("error"===N?"bg-red-50 border border-red-300":"bg-green-50 border border-green-300"),children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-2 ".concat("error"===N?"text-red-600":"text-green-600"),children:"error"===N?"Error":"\xc9xito"}),(0,a.jsx)("p",{className:"mb-4 text-sm",children:j}),(0,a.jsx)("button",{onClick:()=>v(!1),className:"px-4 py-2 rounded font-semibold ".concat("error"===N?"bg-red-600 text-white":"bg-green-600 text-white"," hover:opacity-90 transition"),children:"Cerrar"})]})})]})]})}},1730:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});var a=t(5155);t(2115);let s=()=>(0,a.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,a.jsx)("h4",{children:"Gestion de Empresas"})]})}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=520)),_N_E=e.O()}]);