(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9674],{12873:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>l});var t=r(95155),s=r(51730),i=r(12115),n=r(60907);let o=()=>{let[e,a]=(0,i.useState)([]),[r,s]=(0,i.useState)(null),[o,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(null),[m,h]=(0,i.useState)({estado:"",fecha_vencimiento:"",codigo_lote:"",observaciones:""}),[p,x]=(0,i.useState)(!1),[u,j]=(0,i.useState)(""),[b,g]=(0,i.useState)("success"),[f,v]=(0,i.useState)(!1),N=async()=>{try{let e=await (0,n.yz)();a(e),console.log(e)}catch(e){j("Error al cargar pedidos"),g("error"),v(!0)}};(0,i.useEffect)(()=>{N()},[]);let y=[{label:"Aceptado",value:"disponible"},{label:"Rechazado",value:"rechazado"},{label:"En cuarentena",value:"en_cuarentena"}],w=async e=>{x(!0);try{await (0,n.vn)(e.id,m.fecha_vencimiento,m.estado,m.observaciones,m.codigo_lote),j("Recepci\xf3n registrada correctamente."),g("success"),v(!0),l(null),h({estado:"",fecha_vencimiento:"",codigo_lote:"",observaciones:""}),N()}catch(e){j("Error al registrar la recepci\xf3n."),g("error"),v(!0)}x(!1)},_=async e=>{x(!0);try{await (0,n.Fn)(e),j("Pedido cancelado correctamente."),g("success"),v(!0),d(null),N()}catch(e){j("Error al cancelar el pedido."),g("error"),v(!0)}x(!1)};return(0,t.jsxs)("div",{className:"w-full max-w-2xl mx-auto p-2",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 text-center text-primary",children:"Pedidos de materia prima"}),(0,t.jsx)("div",{className:"overflow-x-auto rounded-lg shadow",children:(0,t.jsxs)("table",{className:"min-w-full bg-white text-xs sm:text-sm",children:[(0,t.jsx)("thead",{className:"bg-primary text-white",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-2",children:"ID"}),(0,t.jsx)("th",{className:"p-2",children:"Materia Prima"}),(0,t.jsx)("th",{className:"p-2",children:"Cantidad"}),(0,t.jsx)("th",{className:"p-2",children:"Proveedor"}),(0,t.jsx)("th",{className:"p-2",children:"Fecha"}),(0,t.jsx)("th",{className:"p-2",children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:0===e.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"text-center p-4",children:"No hay pedidos en espera de materia prima."})}):e.map(e=>(0,t.jsxs)(i.Fragment,{children:[(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"p-2 text-center",children:e.id_materia_prima}),(0,t.jsx)("td",{className:"p-2",children:e.nombre_materia_prima}),(0,t.jsx)("td",{className:"p-2 text-center",children:e.cantidad_total}),(0,t.jsxs)("td",{className:"p-2",children:[e.razon_social_proveedor," ",(0,t.jsx)("button",{className:"text-blue-600 underline",onClick:()=>s(r===e.id?null:e.id),children:"Ver m\xe1s"})]}),(0,t.jsx)("td",{className:"p-2 text-center",children:e.fecha_generacion_pedido.split(" ")[0]}),(0,t.jsxs)("td",{className:"p-2 flex flex-col gap-1 sm:flex-row",children:[(0,t.jsx)("button",{className:"text-s text-white rounded bg-green-600 p-1 hover:opacity-90 transition",onClick:()=>l(e.id),children:"Recibir"}),(0,t.jsx)("button",{className:"text-s text-white rounded bg-red-600 p-1 hover:opacity-90 transition",onClick:()=>d(e.id),children:"Cancelar"})]})]}),r===e.id&&(0,t.jsx)("tr",{className:"bg-gray-50",children:(0,t.jsx)("td",{colSpan:7,className:"p-2",children:(0,t.jsxs)("div",{className:"flex flex-col gap-1 text-xs sm:text-sm",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("b",{children:"Tel\xe9fono:"})," ",e.telefono_proveedor]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("b",{children:"Email:"})," ",e.email_proveedor]})]})})}),o===e.id&&(0,t.jsx)("tr",{className:"bg-green-50",children:(0,t.jsx)("td",{colSpan:7,className:"p-2",children:(0,t.jsxs)("form",{className:"flex flex-col gap-2",onSubmit:a=>{a.preventDefault(),w(e)},children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("b",{children:"ID:"})," ",e.id_materia_prima]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("b",{children:"Materia Prima:"})," ",e.nombre_materia_prima]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("b",{children:"Cantidad:"})," ",e.cantidad_total]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("b",{children:"Proveedor:"})," ",e.razon_social_proveedor]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("b",{children:"Fecha:"})," ",e.fecha_generacion_pedido.split(" ")[0]]})]}),(0,t.jsx)("label",{className:"text-sm font-medium",children:"Estado de recepci\xf3n"}),(0,t.jsxs)("select",{required:!0,className:"border rounded px-2 py-1",value:m.estado,onChange:e=>h(a=>({...a,estado:e.target.value})),children:[(0,t.jsx)("option",{value:"",children:"Selecciona estado"}),y.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]}),e.expirable&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Fecha de vencimiento "}),(0,t.jsx)("input",{type:"date",className:"border rounded px-2 py-1",required:!0,value:m.fecha_vencimiento,onChange:e=>h(a=>({...a,fecha_vencimiento:e.target.value}))})]}),(0,t.jsx)("label",{className:"text-sm font-medium",children:"C\xf3digo de lote"}),(0,t.jsx)("input",{type:"text",className:"border rounded px-2 py-1",required:!0,value:m.codigo_lote,onChange:e=>h(a=>({...a,codigo_lote:e.target.value}))}),(0,t.jsx)("label",{className:"text-sm font-medium",children:"Observaciones (opcional)"}),(0,t.jsx)("textarea",{className:"border rounded px-2 py-1",value:m.observaciones,onChange:e=>h(a=>({...a,observaciones:e.target.value}))}),(0,t.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,t.jsx)("button",{type:"submit",disabled:p,className:"bg-green-600 text-white px-4 py-1 rounded font-semibold",children:"Registrar"}),(0,t.jsx)("button",{type:"button",className:"bg-gray-400 text-white px-4 py-1 rounded font-semibold",onClick:()=>l(null),children:"Cancelar"})]})]})})}),c===e.id&&(0,t.jsx)("tr",{className:"bg-red-50",children:(0,t.jsx)("td",{colSpan:7,className:"p-2",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("span",{children:"\xbfSeguro que quieres cancelar el pedido?"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"bg-red-600 text-white px-4 py-1 rounded font-semibold",onClick:()=>_(e.id),children:"Confirmar"}),(0,t.jsx)("button",{className:"bg-gray-400 text-white px-4 py-1 rounded font-semibold",onClick:()=>d(null),children:"Volver"})]})]})})})]},e.id))})]})}),f&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,t.jsxs)("div",{className:"rounded-lg p-6 shadow-lg w-80 text-center ".concat("error"===b?"bg-red-50 border border-red-300":"bg-green-50 border border-green-300"),children:[(0,t.jsx)("h3",{className:"text-lg font-bold mb-2 ".concat("error"===b?"text-red-600":"text-green-600"),children:"error"===b?"Error":"\xc9xito"}),(0,t.jsx)("p",{className:"mb-4 text-sm",children:u}),(0,t.jsx)("button",{onClick:()=>v(!1),className:"px-4 py-2 rounded font-semibold ".concat("error"===b?"bg-red-600 text-white":"bg-green-600 text-white"," hover:opacity-90 transition"),children:"Cerrar"})]})})]})},l=()=>(0,t.jsxs)("div",{className:"min-h-screen bg-neutral-light",children:[(0,t.jsx)(s.default,{}),(0,t.jsx)("main",{className:"p-6 space-y-4",children:(0,t.jsx)(o,{})})]})},20063:(e,a,r)=>{"use strict";var t=r(47260);r.o(t,"usePathname")&&r.d(a,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}})},28448:(e,a,r)=>{Promise.resolve().then(r.bind(r,12873))},51730:(e,a,r)=>{"use strict";r.d(a,{default:()=>n});var t=r(95155);r(12115);var s=r(20063),i=r(84926);let n=()=>{let e=(0,s.useRouter)();return(0,t.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center relative flex items-center justify-center",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,t.jsx)("h4",{children:"El N\xfacleo de tu Empresa"})]}),(0,t.jsxs)("button",{onClick:()=>{e.push("/")},className:"absolute top-1/2 right-4 -translate-y-1/2 flex items-center gap-2 px-3 py-1.5 text-sm font-semibold bg-white text-primary rounded-md hover:bg-gray-200 transition","aria-label":"Cerrar sesi\xf3n",children:[(0,t.jsx)(i.A,{size:16}),(0,t.jsx)("span",{children:"Salir"})]})]})}},60907:(e,a,r)=>{"use strict";r.d(a,{$Z:()=>c,Fn:()=>l,OX:()=>i,vn:()=>o,yz:()=>n,zI:()=>s});let t="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function s(){let e=await fetch("".concat(t,"/gestion-materia-prima/all-proveedores-por-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching materia prima x proovedor");return(await e.json()).materias_primas}async function i(e){let{idMateriaPrima:a,idProveedor:r,cantidad:s}=e,i=await fetch("".concat(t,"/gestion-materia-prima/generar-compra-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_materia_prima:a,id_proveedor:r,cantidad_total:s})});if(!i.ok)throw Error((await i.json()).error||"Error al pedir materia prima");return i.json()}async function n(){let e=await fetch("".concat(t,"/gestion-materia-prima/pedido-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos materia prima");return(await e.json()).pedidos_materia_prima}async function o(e,a,r,s,i){console.log(e,a,r,s,i);let n=await fetch("".concat(t,"/gestion-materia-prima/update-actualizar-estado-lote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_lote:e,fecha_vencimiento:a,nuevo_estado:r,observaciones:s,codigo_lote:i})});if(!n.ok)throw Error((await n.json()).error||"Error al actualizar el estado del pedido");return n.json()}async function l(e){let a=await fetch("".concat(t,"/gestion-materia-prima/rechazar-pedido-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e})});if(!a.ok)throw Error((await a.json()).error||"Error al cancelar el pedido");return a.json()}async function c(){let e=await fetch("".concat(t,"/gestion-materia-prima/stock"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching stock materia prima");return(await e.json()).stock_materia_prima}},71847:(e,a,r)=>{"use strict";r.d(a,{A:()=>l});var t=r(12115);let s=e=>{let a=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,r)=>r?r.toUpperCase():a.toLowerCase());return a.charAt(0).toUpperCase()+a.slice(1)},i=function(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return a.filter((e,a,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===a).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)((e,a)=>{let{color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:m,...h}=e;return(0,t.createElement)("svg",{ref:a,...n,width:s,height:s,stroke:r,strokeWidth:l?24*Number(o)/Number(s):o,className:i("lucide",c),...!d&&!(e=>{for(let a in e)if(a.startsWith("aria-")||"role"===a||"title"===a)return!0})(h)&&{"aria-hidden":"true"},...h},[...m.map(e=>{let[a,r]=e;return(0,t.createElement)(a,r)}),...Array.isArray(d)?d:[d]])}),l=(e,a)=>{let r=(0,t.forwardRef)((r,n)=>{let{className:l,...c}=r;return(0,t.createElement)(o,{ref:n,iconNode:a,className:i("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...c})});return r.displayName=s(e),r}},84926:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(71847).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=28448)),_N_E=e.O()}]);