(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4392],{10841:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(95155),i=r(60907),o=r(51730),n=r(12115);let s=()=>{let[e,t]=(0,n.useState)([]),[r,s]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),[d,m]=(0,n.useState)(""),[u,p]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[g,x]=(0,n.useState)(""),[b,y]=(0,n.useState)("success"),j=n.useMemo(()=>{if(!r)return[];let t=e.find(e=>e.id_materia_prima===r);return(null==t?void 0:t.proveedores)||[]},[r,e]);(0,n.useEffect)(()=>{(async()=>{t(await (0,i.zI)())})()},[]);let w=async e=>{if(e.preventDefault(),!r||!l){x("Selecciona materia prima y proveedor."),y("error"),f(!0);return}let t=Number(d);if(isNaN(t)||t<=0){x("La cantidad debe ser un n\xfamero positivo."),y("error"),f(!0);return}p(!0);try{await (0,i.OX)({idMateriaPrima:Number(r),idProveedor:Number(l),cantidad:t}),x("Pedido realizado con \xe9xito."),y("success"),f(!0),s(""),c(""),m("")}catch(e){x(e instanceof Error?e.message:"Error al realizar el pedido."),y("error"),f(!0)}p(!1)};return(0,a.jsxs)("div",{className:"min-h-screen bg-neutral-light",children:[(0,a.jsx)(o.default,{}),(0,a.jsxs)("main",{className:"p-4 flex flex-col items-center justify-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-primary mb-4 text-center",children:"Realizar pedido de materia prima"}),(0,a.jsxs)("form",{onSubmit:w,className:"w-full max-w-sm bg-white rounded-lg shadow-md p-6 flex flex-col gap-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Materia prima"}),(0,a.jsxs)("select",{value:r,onChange:e=>{s(Number(e.target.value)),c("")},className:"rounded border px-3 py-2",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Selecciona materia prima"}),e.map(e=>(0,a.jsx)("option",{value:e.id_materia_prima,children:e.nombre_materia_prima},e.id_materia_prima))]}),(0,a.jsx)("label",{className:"text-sm font-medium",children:"Proveedor"}),(0,a.jsxs)("select",{value:l,onChange:e=>c(Number(e.target.value)),className:"rounded border px-3 py-2",required:!0,disabled:0===j.length,children:[(0,a.jsx)("option",{value:"",children:"Selecciona proveedor"}),j.map(e=>(0,a.jsxs)("option",{value:e.id_proveedor,children:[e.nombre_contacto," - ",e.razon_social]},e.id_proveedor))]}),(0,a.jsx)("label",{className:"text-sm font-medium",children:"Cantidad"}),(0,a.jsx)("input",{type:"number",min:"1",value:d,onChange:e=>m(e.target.value),className:"rounded border px-3 py-2",placeholder:"Cantidad",required:!0}),(0,a.jsx)("button",{type:"submit",disabled:u,className:"bg-primary text-white rounded py-2 font-semibold mt-2 hover:opacity-90 transition",children:u?"Enviando...":"Pedir"})]}),h&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,a.jsxs)("div",{className:"rounded-lg p-6 shadow-lg w-80 text-center ".concat("error"===b?"bg-red-50 border border-red-300":"bg-green-50 border border-green-300"),children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-2 ".concat("error"===b?"text-red-600":"text-green-600"),children:"error"===b?"Error":"\xc9xito"}),(0,a.jsx)("p",{className:"mb-4 text-sm",children:g}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"px-4 py-2 rounded font-semibold ".concat("error"===b?"bg-red-600 text-white":"bg-green-600 text-white"," hover:opacity-90 transition"),children:"Cerrar"})]})})]})]})}},15239:(e,t,r)=>{"use strict";r.d(t,{default:()=>i.a});var a=r(54652),i=r.n(a)},20063:(e,t,r)=>{"use strict";var a=r(47260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},51730:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var a=r(95155);r(12115);var i=r(20063),o=r(84926),n=r(15239);let s=()=>{let e=(0,i.useRouter)();return(0,a.jsxs)("header",{className:"relative flex items-center justify-center py-3 text-center text-white",children:[(0,a.jsx)(n.default,{src:"/Banner.jpg",alt:"Banner",fill:!0,priority:!0,className:"object-cover "}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,a.jsx)("h4",{children:"El N\xfacleo de tu Empresa"})]}),(0,a.jsxs)("button",{onClick:()=>{e.push("/")},className:"absolute top-1/2 right-4 -translate-y-1/2 flex items-center gap-2 px-3 py-1.5 text-sm font-semibold bg-white text-primary rounded-md hover:bg-gray-200 transition","aria-label":"Cerrar sesi\xf3n",children:[(0,a.jsx)(o.A,{size:16}),(0,a.jsx)("span",{})]})]})}},54652:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return s}});let a=r(28140),i=r(75040),o=r(81356),n=a._(r(71124));function s(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=o.Image},60907:(e,t,r)=>{"use strict";r.d(t,{$Z:()=>c,Fn:()=>l,Kb:()=>u,Mm:()=>d,OX:()=>o,UO:()=>m,vn:()=>s,yz:()=>n,zI:()=>i});let a="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function i(){let e=await fetch("".concat(a,"/gestion-materia-prima/all-proveedores-por-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching materia prima x proovedor");return(await e.json()).materias_primas}async function o(e){let{idMateriaPrima:t,idProveedor:r,cantidad:i}=e,o=await fetch("".concat(a,"/gestion-materia-prima/generar-compra-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_materia_prima:t,id_proveedor:r,cantidad_total:i})});if(!o.ok)throw Error((await o.json()).error||"Error al pedir materia prima");return o.json()}async function n(){let e=await fetch("".concat(a,"/gestion-materia-prima/pedido-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos materia prima");return(await e.json()).pedidos_materia_prima}async function s(e,t,r,i,o){console.log(e,t,r,i,o);let n=await fetch("".concat(a,"/gestion-materia-prima/update-actualizar-estado-lote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_lote:e,fecha_vencimiento:t,nuevo_estado:r,observaciones:i,codigo_lote:o})});if(!n.ok)throw Error((await n.json()).error||"Error al actualizar el estado del pedido");return n.json()}async function l(e){let t=await fetch("".concat(a,"/gestion-materia-prima/rechazar-pedido-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e})});if(!t.ok)throw Error((await t.json()).error||"Error al cancelar el pedido");return t.json()}async function c(){let e=await fetch("".concat(a,"/gestion-materia-prima/stock"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching stock materia prima");return(await e.json()).stock_materia_prima}async function d(){let e=await fetch("".concat(a,"/gestion-materia-prima/get-aceptar-materia-prima-automatico"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error accepting materia prima");return await e.json()}async function m(){let e=await fetch("".concat(a,"/gestion-materia-prima/get-all-lotes-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching stock materia prima");let t=await e.json();return console.log(t),t.materias_primas}async function u(e){let t=await fetch("".concat(a,"/gestion-materia-prima/post-pdf-trazabilidad-lote"),{method:"POST",headers:{"Content-Type":"application/pdf"},body:JSON.stringify({lote_id:e})});if(!t.ok)throw Error("Error fetching PDF");let r=await t.text();return console.log("Blob del PDF:",r),r}},71847:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(12115);let i=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:m,...u}=e;return(0,a.createElement)("svg",{ref:t,...n,width:i,height:i,stroke:r,strokeWidth:l?24*Number(s)/Number(i):s,className:o("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(u)&&{"aria-hidden":"true"},...u},[...m.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:l,...c}=r;return(0,a.createElement)(s,{ref:n,iconNode:t,className:o("lucide-".concat(i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...c})});return r.displayName=i(e),r}},82882:(e,t,r)=>{Promise.resolve().then(r.bind(r,10841))},84926:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])}},e=>{e.O(0,[1356,8441,1255,7358],()=>e(e.s=82882)),_N_E=e.O()}]);