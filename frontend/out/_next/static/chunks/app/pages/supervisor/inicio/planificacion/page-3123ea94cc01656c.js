(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2859],{51730:(e,o,t)=>{"use strict";t.d(o,{default:()=>i});var r=t(95155);t(12115);var n=t(20063),a=t(84926);let i=()=>{let e=(0,n.useRouter)();return(0,r.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center relative flex items-center justify-center",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,r.jsx)("h4",{children:"El N\xfacleo de tu Empresa"})]}),(0,r.jsxs)("button",{onClick:()=>{e.push("/")},className:"absolute top-1/2 right-4 -translate-y-1/2 flex items-center gap-2 px-3 py-1.5 text-sm font-semibold bg-white text-primary rounded-md hover:bg-gray-200 transition","aria-label":"Cerrar sesi\xf3n",children:[(0,r.jsx)(a.A,{size:16}),(0,r.jsx)("span",{children:"Salir"})]})]})}},58213:(e,o,t)=>{"use strict";t.d(o,{Bs:()=>n,K5:()=>a,Z0:()=>c,Z7:()=>i});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function n(){let e=await fetch("".concat(r,"/orden-produccion/orden-produccion-listaprd-enproceso-finalizada"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");let o=await e.json();return Array.isArray(o.ordenes_produccion)?o.ordenes_produccion:[]}async function a(e,o){if(console.log("actualizar ot "+e+" a estado: "+o),!(await fetch("".concat(r,"/orden-produccion/update-orden-produccion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_orden_produccion:e,estado:o})})).ok)throw Error("Error updating orden de produccion")}async function i(e){console.log("fetch ordenes de produccion en estado: "+e);let o=await fetch("".concat(r,"/orden-produccion/listar-orden-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado_orden_produccion:e})});if(!o.ok)throw Error("Error fetching productos");return(await o.json()).ordenes_produccion}async function c(e){let o={id_orden_produccion:e},t=await fetch("".concat(r,"/orden-produccion/post-get-orden-produccion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw Error("Error fetching orden de produccion details");let n=await t.json();return console.log("Detalles de la orden de produccion:",o),n.orden_produccion}},65060:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>h});var r=t(95155),n=t(51730),a=t(12115),i=t(96440),c=t(36385),s=t(12411),d=t(97081),l=t(58213);let p={atrasado:"#FFA500",en_tiempo:"#16A34A",por_vencer:"#DC2626"};function u(e){let{planificacion:o}=e,[t,n]=(0,a.useState)(!1),[i,u]=(0,a.useState)(null),h=(0,a.useMemo)(()=>o?Object.entries(o).flatMap(e=>{let[o,t]=e;return t.map(e=>({id:String(e.id_orden_produccion),title:"#".concat(e.id_orden_produccion),start:o,backgroundColor:p[e.estado_pedido],borderColor:p[e.estado_pedido],extendedProps:{estado:e.estado_pedido}}))}):[],[o]);async function m(e){try{let o=await (0,l.Z0)(e);u(o),console.log("Detalles de la orden de produccion:",o),n(!0)}catch(e){console.error("Error fetching order details:",e)}}return(0,r.jsxs)("div",{children:[(0,r.jsx)(c.A,{plugins:[s.A,d.Ay],initialView:"dayGridMonth",events:h,eventContent:e=>{let o=Number(e.event.id);return(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"text-xs font-medium",style:{color:"white"},children:e.event.title}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation();try{m(o)}catch(e){console.error("Error fetching order details:",e)}},className:"ml-2 text-[10px] bg-white text-black rounded px-1 py-0.5",children:"ver m\xe1s"})]})},height:"auto",dayMaxEventRows:!0}),t&&i&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold mb-1",children:["Orden de Producci\xf3n #",i.id]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Pedido de Venta #",i.id_orden_venta]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Cliente:"})," ",i.cliente]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Producto:"})," ",i.nombre_producto]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Cantidad:"})," ",i.cantidad," bultos"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Fecha de Entrega Solicitada:"})," ",new Date(i.fecha_entrega_solicitada).toLocaleDateString()," "]}),(0,r.jsxs)("details",{className:"pt-2",children:[(0,r.jsx)("summary",{className:"cursor-pointer font-semibold",children:"Materias Primas Requeridas"}),(0,r.jsx)("ul",{className:"list-disc pl-5 mt-2 text-xs text-gray-700",children:i.materias_primas&&i.materias_primas.map(e=>(0,r.jsxs)("li",{children:[e.nombre_materia_prima,": ",e.cantidad_utilizada," ",e.unidad_medida]},e.id))})]})]}),(0,r.jsx)("div",{className:"mt-4 flex justify-end",children:(0,r.jsx)("button",{onClick:()=>n(!1),className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Cerrar"})})]})})]})}let h=()=>{let[e,o]=(0,a.useState)([]);(0,a.useEffect)(()=>{!async function(){let e=await (0,i.tv)();console.log(e),o(e)}()},[]);let t=e.reduce((e,o)=>({...e,...o}),{});return(0,r.jsxs)("div",{className:"min-h-screen bg-neutral-light",children:[(0,r.jsx)(n.default,{}),(0,r.jsx)(u,{planificacion:t})]})}},74191:(e,o,t)=>{Promise.resolve().then(t.bind(t,65060))},96440:(e,o,t)=>{"use strict";t.d(o,{Ec:()=>n,N0:()=>i,sI:()=>c,tv:()=>s,w_:()=>a});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function n(e){let o=await fetch("".concat(r,"/tanda-produccion/post-obtener-tanda-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!o.ok)throw Error("Error fetching tandas sugeridas");let t=await o.json();return console.log("tandas"+t.lineas_produccion),t.lineas_produccion}async function a(e,o){if(console.log("actualizar ot "+e+" a estado: "+o),console.log("actualizar ot "+e+" a estado: "+o),!(await fetch("".concat(r,"/tanda-produccion/post-update-tandas-produccion-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_tandas:e,estado:o})})).ok)throw Error("Error updating tanda produccion")}async function i(){let e=await fetch("".concat(r,"/tanda-produccion/get-all-ordenes-produccion-aceptadas-por-linea-produccion"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error generating tanda");let o=await e.json();return console.log(o),o.lineas_produccion}async function c(e){console.log("Crear Tanda Produccion Manual: ",JSON.stringify({id_linea_produccion:e.id_linea_produccion,ordenes_produccion:e.ordenes_produccion}));let o=await fetch("".concat(r,"/tanda-produccion/post-crear-tandas-produccion-manual"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok){let e=await o.json();throw console.log("Error creating tanda produccion manual:",e),Error(e.error||"Error creating tanda produccion manual")}return o.json()}async function s(){try{let e=await fetch("".concat(r,"/orden-produccion/planificador_op_daily"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let o=await e.json();throw Error(o.error||"Error fetching planificacion data")}return await e.json()}catch(e){throw console.log("error general: "+e),e}}}},e=>{e.O(0,[6018,1949,8441,1255,7358],()=>e(e.s=74191)),_N_E=e.O()}]);