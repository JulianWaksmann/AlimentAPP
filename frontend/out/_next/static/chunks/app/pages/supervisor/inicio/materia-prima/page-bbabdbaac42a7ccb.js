(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[392],{841:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>s});var t=a(5155),i=a(907),o=a(1730),n=a(2115);let s=()=>{let[e,r]=(0,n.useState)([]),[a,s]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[l,m]=(0,n.useState)(""),[p,u]=(0,n.useState)(!1),[h,x]=(0,n.useState)(!1),[f,b]=(0,n.useState)(""),[g,j]=(0,n.useState)("success"),y=n.useMemo(()=>{if(!a)return[];let r=e.find(e=>e.id_materia_prima===a);return(null==r?void 0:r.proveedores)||[]},[a,e]);(0,n.useEffect)(()=>{(async()=>{r(await (0,i.zI)())})()},[]);let v=async e=>{if(e.preventDefault(),!a||!d){b("Selecciona materia prima y proveedor."),j("error"),x(!0);return}let r=Number(l);if(isNaN(r)||r<=0){b("La cantidad debe ser un n\xfamero positivo."),j("error"),x(!0);return}u(!0);try{await (0,i.OX)({idMateriaPrima:Number(a),idProveedor:Number(d),cantidad:r}),b("Pedido realizado con \xe9xito."),j("success"),x(!0),s(""),c(""),m("")}catch(e){b(e instanceof Error?e.message:"Error al realizar el pedido."),j("error"),x(!0)}u(!1)};return(0,t.jsxs)("div",{className:"min-h-screen bg-neutral-light",children:[(0,t.jsx)(o.A,{}),(0,t.jsxs)("main",{className:"p-4 flex flex-col items-center justify-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-primary mb-4 text-center",children:"Realizar pedido de materia prima"}),(0,t.jsxs)("form",{onSubmit:v,className:"w-full max-w-sm bg-white rounded-lg shadow-md p-6 flex flex-col gap-4",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Materia prima"}),(0,t.jsxs)("select",{value:a,onChange:e=>{s(Number(e.target.value)),c("")},className:"rounded border px-3 py-2",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona materia prima"}),e.map(e=>(0,t.jsx)("option",{value:e.id_materia_prima,children:e.nombre_materia_prima},e.id_materia_prima))]}),(0,t.jsx)("label",{className:"text-sm font-medium",children:"Proveedor"}),(0,t.jsxs)("select",{value:d,onChange:e=>c(Number(e.target.value)),className:"rounded border px-3 py-2",required:!0,disabled:0===y.length,children:[(0,t.jsx)("option",{value:"",children:"Selecciona proveedor"}),y.map(e=>(0,t.jsxs)("option",{value:e.id_proveedor,children:[e.nombre_contacto," - ",e.razon_social]},e.id_proveedor))]}),(0,t.jsx)("label",{className:"text-sm font-medium",children:"Cantidad"}),(0,t.jsx)("input",{type:"number",min:"1",value:l,onChange:e=>m(e.target.value),className:"rounded border px-3 py-2",placeholder:"Cantidad",required:!0}),(0,t.jsx)("button",{type:"submit",disabled:p,className:"bg-primary text-white rounded py-2 font-semibold mt-2 hover:opacity-90 transition",children:p?"Enviando...":"Pedir"})]}),h&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,t.jsxs)("div",{className:"rounded-lg p-6 shadow-lg w-80 text-center ".concat("error"===g?"bg-red-50 border border-red-300":"bg-green-50 border border-green-300"),children:[(0,t.jsx)("h3",{className:"text-lg font-bold mb-2 ".concat("error"===g?"text-red-600":"text-green-600"),children:"error"===g?"Error":"\xc9xito"}),(0,t.jsx)("p",{className:"mb-4 text-sm",children:f}),(0,t.jsx)("button",{onClick:()=>x(!1),className:"px-4 py-2 rounded font-semibold ".concat("error"===g?"bg-red-600 text-white":"bg-green-600 text-white"," hover:opacity-90 transition"),children:"Cerrar"})]})})]})]})}},907:(e,r,a)=>{"use strict";a.d(r,{$Z:()=>c,Fn:()=>d,OX:()=>o,vn:()=>s,yz:()=>n,zI:()=>i});let t="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function i(){let e=await fetch("".concat(t,"/gestion-materia-prima/all-proveedores-por-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching materia prima x proovedor");return(await e.json()).materias_primas}async function o(e){let{idMateriaPrima:r,idProveedor:a,cantidad:i}=e,o=await fetch("".concat(t,"/gestion-materia-prima/generar-compra-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_materia_prima:r,id_proveedor:a,cantidad_total:i})});if(!o.ok)throw Error((await o.json()).error||"Error al pedir materia prima");return o.json()}async function n(){let e=await fetch("".concat(t,"/gestion-materia-prima/pedido-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos materia prima");return(await e.json()).pedidos_materia_prima}async function s(e,r,a,i,o){console.log(e,r,a,i,o);let n=await fetch("".concat(t,"/gestion-materia-prima/update-actualizar-estado-lote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_lote:e,fecha_vencimiento:r,nuevo_estado:a,observaciones:i,codigo_lote:o})});if(!n.ok)throw Error((await n.json()).error||"Error al actualizar el estado del pedido");return n.json()}async function d(e){let r=await fetch("".concat(t,"/gestion-materia-prima/rechazar-pedido-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e})});if(!r.ok)throw Error((await r.json()).error||"Error al cancelar el pedido");return r.json()}async function c(){let e=await fetch("".concat(t,"/gestion-materia-prima/stock"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching stock materia prima");return(await e.json()).stock_materia_prima}},1730:(e,r,a)=>{"use strict";a.d(r,{A:()=>i});var t=a(5155);a(2115);let i=()=>(0,t.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,t.jsx)("h4",{children:"Gestion de Empresas"})]})},2882:(e,r,a)=>{Promise.resolve().then(a.bind(a,841))}},e=>{e.O(0,[441,255,358],()=>e(e.s=2882)),_N_E=e.O()}]);