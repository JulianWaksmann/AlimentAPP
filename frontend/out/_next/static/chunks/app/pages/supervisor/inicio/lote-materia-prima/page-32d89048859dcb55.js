(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4105],{15239:(e,t,a)=>{"use strict";a.d(t,{default:()=>i.a});var r=a(54652),i=a.n(r)},20063:(e,t,a)=>{"use strict";var r=a(47260);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},26274:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var r=a(95155),i=a(12115),o=a(60907),s=a(51730);let n=()=>{var e;let[t,a]=(0,i.useState)([]),[n,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null),[m,p]=(0,i.useState)("");async function u(e){let t=null;try{let a=await (0,o.Kb)(e),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/pdf",a=atob(e),r=Array(a.length);for(let e=0;e<a.length;e++)r[e]=a.charCodeAt(e);return new Blob([new Uint8Array(r)],{type:t})}(a,"application/pdf");t=URL.createObjectURL(r),window.open(t,"_blank")||console.warn("La ventana emergente fue bloqueada por el navegador. Habil\xedtela para ver el PDF.")}catch(e){console.error("Error al abrir el PDF:",e)}t&&URL.revokeObjectURL(t)}(0,i.useEffect)(()=>{!async function(){l(!0);try{let e=await (0,o.UO)(),t="object"==typeof e&&null!==e&&"materias_primas"in e&&Array.isArray(e.materias_primas)?e.materias_primas:e;a(Array.isArray(t)?t:[])}catch(e){console.error("Error al obtener lotes:",e),a([])}finally{l(!1)}}()},[]);let h=null!=(e=t.find(e=>e.id_materia_prima===c))?e:null,f=h?h.lotes.filter(e=>e.codigo_lote.toLowerCase().includes(m.trim().toLowerCase())):[];return(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)(s.default,{}),(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold mb-4 text-center",children:"Lotes de Materias Primas"}),n?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)("span",{className:"inline-block h-6 w-6 animate-spin rounded-full border-2 border-gray-300 border-t-primary"})}):0===t.length?(0,r.jsx)("p",{className:"text-center",children:"No hay materias primas."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-4",children:t.map(e=>(0,r.jsx)("button",{onClick:()=>{d(t=>t===e.id_materia_prima?null:e.id_materia_prima),p("")},className:"flex-shrink-0 px-3 py-2 rounded-full text-sm font-medium ".concat(c===e.id_materia_prima?"bg-primary text-white":"bg-gray-100 text-gray-800"),children:e.nombre_materia_prima},e.id_materia_prima))}),h?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:h.nombre_materia_prima}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Unidad: ",h.unidad_medida]})]}),(0,r.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,r.jsx)("input",{value:m,onChange:e=>p(e.target.value),type:"text",placeholder:"Buscar por c\xf3digo de lote (ej. LT-1212)",className:"flex-1 px-3 py-2 border rounded-md text-sm"}),(0,r.jsx)("button",{onClick:()=>p(""),className:"px-3 py-2 bg-gray-100 rounded-md text-sm",children:"Limpiar"})]}),0===f.length?(0,r.jsx)("p",{className:"text-sm text-center text-gray-600",children:"No se encontraron lotes."}):(0,r.jsx)("ul",{className:"space-y-3",children:f.map(e=>(0,r.jsx)("li",{className:"border rounded-lg p-3 bg-white shadow-sm",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("span",{className:"text-sm",children:"C\xf3digo:"}),(0,r.jsx)("span",{className:"text-xs",children:e.codigo_lote}),(0,r.jsx)("span",{className:"ml-2 text-xs px-2 py-1 rounded-full ".concat("disponible"===e.estado?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.estado})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Proveedor: ",e.nombre_proveedor]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Cantidad: ",e.cantidad_total," ",h.unidad_medida]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Ingreso: ",e.fecha_ingreso]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Vencimiento: ",e.fecha_vencimiento]})]}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("button",{onClick:()=>{console.log("Descargar informe - id_lote:",e.id_lote),u(e.id_lote)},className:"px-3 py-2 bg-primary text-white rounded-md text-sm",children:"Descargar informe"})})]})},e.id_lote))})]}):(0,r.jsx)("p",{className:"text-center text-sm text-gray-600",children:"Selecciona una materia prima para ver su historial de lotes."})]})]})]})}},51730:(e,t,a)=>{"use strict";a.d(t,{default:()=>n});var r=a(95155);a(12115);var i=a(20063),o=a(84926),s=a(15239);let n=()=>{let e=(0,i.useRouter)();return(0,r.jsxs)("header",{className:"relative flex items-center justify-center py-3 text-center text-white",children:[(0,r.jsx)(s.default,{src:"/Banner.jpg",alt:"Banner",fill:!0,priority:!0,className:"object-cover "}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,r.jsx)("h4",{children:"El N\xfacleo de tu Empresa"})]}),(0,r.jsxs)("button",{onClick:()=>{e.push("/")},className:"absolute top-1/2 right-4 -translate-y-1/2 flex items-center gap-2 px-3 py-1.5 text-sm font-semibold bg-white text-primary rounded-md hover:bg-gray-200 transition","aria-label":"Cerrar sesi\xf3n",children:[(0,r.jsx)(o.A,{size:16}),(0,r.jsx)("span",{})]})]})}},53241:(e,t,a)=>{Promise.resolve().then(a.bind(a,26274))},54652:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return l},getImageProps:function(){return n}});let r=a(28140),i=a(75040),o=a(81356),s=r._(a(71124));function n(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let l=o.Image},60907:(e,t,a)=>{"use strict";a.d(t,{$Z:()=>c,Fn:()=>l,Kb:()=>p,Mm:()=>d,OX:()=>o,UO:()=>m,vn:()=>n,yz:()=>s,zI:()=>i});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function i(){let e=await fetch("".concat(r,"/gestion-materia-prima/all-proveedores-por-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching materia prima x proovedor");return(await e.json()).materias_primas}async function o(e){let{idMateriaPrima:t,idProveedor:a,cantidad:i}=e,o=await fetch("".concat(r,"/gestion-materia-prima/generar-compra-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_materia_prima:t,id_proveedor:a,cantidad_total:i})});if(!o.ok)throw Error((await o.json()).error||"Error al pedir materia prima");return o.json()}async function s(){let e=await fetch("".concat(r,"/gestion-materia-prima/pedido-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos materia prima");return(await e.json()).pedidos_materia_prima}async function n(e,t,a,i,o){console.log(e,t,a,i,o);let s=await fetch("".concat(r,"/gestion-materia-prima/update-actualizar-estado-lote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_lote:e,fecha_vencimiento:t,nuevo_estado:a,observaciones:i,codigo_lote:o})});if(!s.ok)throw Error((await s.json()).error||"Error al actualizar el estado del pedido");return s.json()}async function l(e){let t=await fetch("".concat(r,"/gestion-materia-prima/rechazar-pedido-materia-prima"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e})});if(!t.ok)throw Error((await t.json()).error||"Error al cancelar el pedido");return t.json()}async function c(){let e=await fetch("".concat(r,"/gestion-materia-prima/stock"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching stock materia prima");return(await e.json()).stock_materia_prima}async function d(){let e=await fetch("".concat(r,"/gestion-materia-prima/get-aceptar-materia-prima-automatico"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error accepting materia prima");return await e.json()}async function m(){let e=await fetch("".concat(r,"/gestion-materia-prima/get-all-lotes-materia-prima"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching stock materia prima");let t=await e.json();return console.log(t),t.materias_primas}async function p(e){let t=await fetch("".concat(r,"/gestion-materia-prima/post-pdf-trazabilidad-lote"),{method:"POST",headers:{"Content-Type":"application/pdf"},body:JSON.stringify({lote_id:e})});if(!t.ok)throw Error("Error fetching PDF");let a=await t.text();return console.log("Blob del PDF:",a),a}},71847:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(12115);let i=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:m,...p}=e;return(0,r.createElement)("svg",{ref:t,...s,width:i,height:i,stroke:a,strokeWidth:l?24*Number(n)/Number(i):n,className:o("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(p)&&{"aria-hidden":"true"},...p},[...m.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:l,...c}=a;return(0,r.createElement)(n,{ref:s,iconNode:t,className:o("lucide-".concat(i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...c})});return a.displayName=i(e),a}},84926:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])}},e=>{e.O(0,[1356,8441,1255,7358],()=>e(e.s=53241)),_N_E=e.O()}]);