(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2859],{51730:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var o=r(95155);r(12115);var a=r(20063),n=r(84926),i=r(15239);let c=()=>{let e=(0,a.useRouter)();return(0,o.jsxs)("header",{className:"relative flex items-center justify-center py-3 text-center text-white",children:[(0,o.jsx)(i.default,{src:"/Banner.jpg",alt:"Banner",fill:!0,priority:!0,className:"object-cover "}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,o.jsx)("h4",{children:"El N\xfacleo de tu Empresa"})]}),(0,o.jsxs)("button",{onClick:()=>{e.push("/")},className:"absolute top-1/2 right-4 -translate-y-1/2 flex items-center gap-2 px-3 py-1.5 text-sm font-semibold bg-white text-primary rounded-md hover:bg-gray-200 transition","aria-label":"Cerrar sesi\xf3n",children:[(0,o.jsx)(n.A,{size:16}),(0,o.jsx)("span",{})]})]})}},58213:(e,t,r)=>{"use strict";r.d(t,{Bs:()=>a,EF:()=>s,K5:()=>n,Z0:()=>c,Z7:()=>i});let o="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function a(){let e=await fetch("".concat(o,"/orden-produccion/orden-produccion-listaprd-enproceso-finalizada"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");let t=await e.json();return Array.isArray(t.ordenes_produccion)?t.ordenes_produccion:[]}async function n(e,t){if(console.log("actualizar ot "+e+" a estado: "+t),!(await fetch("".concat(o,"/orden-produccion/update-orden-produccion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_orden_produccion:e,estado:t})})).ok)throw Error("Error updating orden de produccion")}async function i(e){console.log("fetch ordenes de produccion en estado: "+e);let t=await fetch("".concat(o,"/orden-produccion/listar-orden-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado_orden_produccion:e})});if(!t.ok)throw Error("Error fetching productos");return(await t.json()).ordenes_produccion}async function c(e){let t={id_orden_produccion:e},r=await fetch("".concat(o,"/orden-produccion/post-get-orden-produccion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error("Error fetching orden de produccion details");let a=await r.json();return console.log("Detalles de la orden de produccion:",t),a.orden_produccion}async function s(e,t){let r={id_orden_venta:e,nueva_fecha_solicitada:t};console.log(JSON.stringify(r));let a=await fetch("".concat(o,"/crear-orden-venta/post-cambiar-fecha-solicitada"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error("Error updating fecha de entrega");return await a.json()}},65060:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var o=r(95155),a=r(51730),n=r(12115),i=r(96440),c=r(36385),s=r(983),d=r(97081),l=r(58213),p=r(31442);let u={atrasado:"#FFA500",en_tiempo:"#16A34A",por_vencer:"#DC2626"};function h(e){let{planificacion:t}=e,[r,a]=(0,n.useState)(!1),[i,h]=(0,n.useState)(null),[f,x]=(0,n.useState)(!1),[m,g]=(0,n.useState)(""),[y,j]=(0,n.useState)(""),[b,_]=(0,n.useState)(null),w=(0,n.useRef)(null),v=(0,n.useMemo)(()=>t?Object.entries(t).flatMap(e=>{let[t,r]=e;return r.map(e=>({id:String(e.id_orden_produccion),title:"#".concat(e.id_orden_produccion),start:t,borderColor:u[e.estado_pedido],extendedProps:{estado:e.estado_pedido}}))}):[],[t]);async function N(e,t){try{let r=await (0,l.EF)(e,t);console.log("Fecha actualizada:",r),window.location.reload()}catch(e){console.error("Error al actualizar la fecha:",e)}}async function E(e){try{let t=await (0,l.Z0)(e);h(t),console.log("Detalles de la orden de produccion:",t),a(!0)}catch(e){console.error("Error fetching order details:",e)}}return(0,o.jsxs)("div",{children:[(0,o.jsx)(c.A,{ref:w,dayHeaderFormat:{weekday:"short"},plugins:[s.A,p.A,d.Ay],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",right:"title"},defaultAllDayEventDuration:"24:00",events:v,eventContent:e=>{let t=String(e.event.id),r=b===t;return(0,o.jsxs)("div",{className:"bg-gray-200 p-0.5 border flex flex-col items-center justify-center hover:cursor-pointer ".concat(r?"border-2 border-blue-600 ring-2 ring-blue-300":"border-gray-200"),style:{borderColor:r?void 0:e.event.borderColor},children:[(0,o.jsx)("div",{className:"text-xs",children:"atrasado"===e.event.extendedProps.estado?"\uD83D\uDFE1":"en_tiempo"===e.event.extendedProps.estado?"\uD83D\uDFE2":"\uD83D\uDD34"}),(0,o.jsx)("div",{className:"text-xs",style:{color:"black"},onClick:e=>{e.stopPropagation();var r=Number(t);try{E(r)}catch(e){console.error("Error fetching order details:",e)}},children:e.event.title})]})},weekends:!1,height:"auto"}),r&&i&&(0,o.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,o.jsxs)("h2",{className:"text-xl font-bold mb-1",children:["Orden de Producci\xf3n #",i.id]}),(0,o.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Pedido de Venta #",i.id_orden_venta]}),(0,o.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Cliente:"})," ",i.cliente]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Producto:"})," ",i.nombre_producto]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Cantidad:"})," ",i.cantidad," bultos"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Fecha de Entrega Solicitada:"})," ",new Date(i.fecha_entrega_solicitada).toLocaleDateString()," "]}),(0,o.jsxs)("details",{className:"pt-2",children:[(0,o.jsx)("summary",{className:"cursor-pointer font-semibold",children:"Materias Primas Requeridas"}),(0,o.jsx)("ul",{className:"list-disc pl-5 mt-2 text-xs text-gray-700",children:i.materias_primas&&i.materias_primas.map(e=>(0,o.jsxs)("li",{children:[e.nombre_materia_prima,": ",e.cantidad_utilizada," ",e.unidad_medida]},e.id))})]})]}),(0,o.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,o.jsx)("button",{onClick:()=>a(!1),className:"px-4 py-2 mx-1 bg-success text-white rounded",children:"Cerrar"}),(0,o.jsx)("button",{onClick:()=>{x(!0)},className:"px-4 mx-1 py-2 bg-error text-white rounded",children:"Replanificar"})]})]})}),f&&(0,o.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,o.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Advertencia"}),(0,o.jsxs)("p",{className:"mb-4",children:["Seleccione la nueva fecha de entrega para la Orden #",null==i?void 0:i.id,"?"]}),(0,o.jsx)("p",{className:"text-gray-600 text-xs",children:"la fecha debe ser mayor a la fecha solicitada del pedido"}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{id:"fechaEntrega",required:!0,type:"date",min:(null==i?void 0:i.fecha_entrega_solicitada)?new Date(i.fecha_entrega_solicitada).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],value:m,onChange:e=>g(e.target.value),className:"w-full rounded border px-3 py-2"})}),(0,o.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,o.jsx)("button",{onClick:()=>{x(!1),g("")},className:"px-4 py-2 mx-1 bg-gray-300 text-black rounded",children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",disabled:!m||((null==i?void 0:i.fecha_entrega_solicitada)?m<new Date(i.fecha_entrega_solicitada).toISOString().split("T")[0]:m>new Date().toISOString().split("T")[0]),onClick:()=>{N(i.id_orden_venta,m),x(!1),a(!1)},className:"px-4 py-2 mx-1 bg-error text-white rounded",children:"Replanificar"})]})]})})]})}let f=()=>{let[e,t]=(0,n.useState)([]);(0,n.useEffect)(()=>{!async function(){let e=await (0,i.tv)();console.log(e),t(e)}()},[]);let r=e.reduce((e,t)=>({...e,...t}),{});return(0,o.jsxs)("div",{className:"min-h-screen bg-neutral-light",children:[(0,o.jsx)(a.default,{}),(0,o.jsx)("div",{className:"p-2",children:(0,o.jsx)(h,{planificacion:r})})]})}},74191:(e,t,r)=>{Promise.resolve().then(r.bind(r,65060))},96440:(e,t,r)=>{"use strict";r.d(t,{Ec:()=>a,N0:()=>i,sI:()=>c,tv:()=>s,w_:()=>n});let o="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function a(e){let t=await fetch("".concat(o,"/tanda-produccion/post-obtener-tanda-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!t.ok)throw Error("Error fetching tandas sugeridas");let r=await t.json();return console.log(r),r.lineas_produccion}async function n(e,t){let r={id_tandas:e,estado:t};if(console.log(r),console.log("actualizar ot "+e+" a estado: "+t),!(await fetch("".concat(o,"/tanda-produccion/post-update-tandas-produccion-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw Error("Error updating tanda produccion")}async function i(){let e=await fetch("".concat(o,"/tanda-produccion/get-all-ordenes-produccion-aceptadas-por-linea-produccion"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error generating tanda");let t=await e.json();return console.log(t),t.lineas_produccion}async function c(e){console.log("Crear Tanda Produccion Manual: ",JSON.stringify({id_linea_produccion:e.id_linea_produccion,ordenes_produccion:e.ordenes_produccion}));let t=await fetch("".concat(o,"/tanda-produccion/post-crear-tandas-produccion-manual"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw console.log("Error creating tanda produccion manual:",e),Error(e.error||"Error creating tanda produccion manual")}return t.json()}async function s(){try{let e=await fetch("".concat(o,"/orden-produccion/planificador_op_daily"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.error||"Error fetching planificacion data")}return await e.json()}catch(e){throw console.log("error general: "+e),e}}}},e=>{e.O(0,[6018,1356,2322,8441,1255,7358],()=>e(e.s=74191)),_N_E=e.O()}]);