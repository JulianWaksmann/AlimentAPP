(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9807],{7843:(e,a,t)=>{Promise.resolve().then(t.bind(t,74212))},28569:(e,a,t)=>{"use strict";t.d(a,{NV:()=>o,OV:()=>i,X6:()=>n,lm:()=>r});let s="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function n(){let e=await fetch("".concat(s,"/crear-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).data}async function r(e){console.log("Creando nuevo pedido con data:",e);let a=await fetch("".concat(s,"/crear-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log(JSON.stringify(e)),!a.ok){let e=await a.json();throw Error("Error creating pedido: ".concat(a.status," - ").concat(JSON.stringify(e)))}return a.json()}async function o(){let e=await fetch("".concat(s,"/get-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching solicitudes de venta");return(await e.json()).orden_ventas_pendientes}async function i(e,a){let t=await fetch("".concat(s,"/crear-orden-venta/update-estado-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e,estado:a})});if(!t.ok){let e=await t.json();throw Error("Error updating estado: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}},51730:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});var s=t(95155);t(12115);let n=()=>(0,s.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,s.jsx)("h4",{children:"Gestion de Empresas"})]})},74212:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>d});var s=t(95155),n=t(12115),r=t(28569);function o(e){let{solicitudes:a}=e,[t,o]=(0,n.useState)(!1),[i,d]=(0,n.useState)(null),c=(e,a)=>{d({id:e,accion:a}),o(!0)},l=async()=>{if(!i)return;let{id:e,accion:a}=i;try{await (0,r.OV)(e,a),window.location.reload()}catch(e){console.error("Error actualizando solicitud:",e)}finally{o(!1),d(null)}};return(0,s.jsxs)("div",{className:"overflow-x-auto rounded-lg shadow-lg bg-white p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-primary",children:"Solicitudes de Venta"}),0===a.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"text-center p-4",children:"No hay pedidos en espera de materia prima."})}):(0,s.jsx)("div",{className:" mt-6 space-y-4",children:a.map(e=>(0,s.jsxs)("div",{className:"rounded-lg border p-3 shadow-sm bg-gray-50",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,s.jsxs)("span",{className:"font-bold text-primary",children:["Solicitud #",e.id_orden_venta]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold",children:"Cliente:"})," ",e.nombre_contacto," ",e.apellido_contacto]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold",children:"Valor del pedido:"})," $",e.valor_total_pedido]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold",children:"Raz\xf3n Social:"})," ",e.razon_social]}),(0,s.jsx)("div",{className:"mb-1 font-semibold",children:"Productos:"}),(0,s.jsx)("div",{className:"mb-1 text-sm flex flex-col gap-1",children:Array.isArray(e.productos)?e.productos.map(e=>(0,s.jsxs)("span",{children:[e.nombre," - cantidad: ",e.cantidad]},e.id)):(0,s.jsxs)("span",{children:[e.productos.nombre," : ",e.productos.cantidad]})}),(0,s.jsxs)("div",{children:[" ",(0,s.jsx)("span",{className:"font-semibold",children:"contacto: "}),e.telefono," - ",e.email]}),(0,s.jsxs)("div",{className:"mb-1 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Fecha Pedido:"})," ",e.fecha_pedido]}),(0,s.jsxs)("div",{className:"mb-1 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Fecha Entrega Solicitada:"})," ",e.fecha_entrega]}),(0,s.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,s.jsx)("button",{className:"px-2 py-1 bg-green-200 rounded text-xs",onClick:()=>c(e.id_orden_venta,"confirmada"),children:"Aceptar"}),(0,s.jsx)("button",{className:"px-2 py-1 bg-red-200 rounded text-xs",onClick:()=>c(e.id_orden_venta,"cancelada"),children:"Rechazar"})]})]},e.id_orden_venta))}),t&&i&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Confirmaci\xf3n"}),(0,s.jsxs)("p",{className:"text-sm",children:["\xbfDesea ","confirmada"===i.accion?"aceptar":"rechazar"," la solicitud #",i.id,"?"]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)("button",{onClick:l,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md",children:"S\xed, confirmar"}),(0,s.jsx)("button",{onClick:()=>{o(!1),d(null)},className:"px-4 py-2 bg-gray-100 rounded-md",children:"Cancelar"})]})]})})]})}var i=t(51730);let d=()=>{let[e,a]=(0,n.useState)([]);return(0,n.useEffect)(()=>{!async function(){a(await (0,r.NV)())}()},[]),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.A,{}),(0,s.jsx)("h1",{className:"text-3xl font-bold mb-4 text-primary text-center m-2",children:"Ventas Pendientes de Aprobaci\xf3n"}),(0,s.jsx)("div",{className:" items-center p-6 bg-white border-b border-details",children:(0,s.jsx)(o,{solicitudes:e})})]})}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=7843)),_N_E=e.O()}]);