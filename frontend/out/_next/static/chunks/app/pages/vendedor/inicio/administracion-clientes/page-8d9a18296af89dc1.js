(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7701],{8803:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},20562:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},28569:(e,t,a)=>{"use strict";a.d(t,{$1:()=>d,A1:()=>x,LP:()=>m,NV:()=>s,OV:()=>i,Ob:()=>g,Sr:()=>u,UE:()=>h,X6:()=>o,dC:()=>l,gq:()=>p,lm:()=>n,s1:()=>c});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function o(){let e=await fetch("".concat(r,"/crear-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).data}async function n(e){console.log("Creando nuevo pedido con data:",e);let t=await fetch("".concat(r,"/crear-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log(JSON.stringify(e)),!t.ok){let e=await t.json();throw Error("Error creating pedido: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}async function s(){let e=await fetch("".concat(r,"/get-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching solicitudes de venta");return(await e.json()).orden_ventas_pendientes}async function i(e,t){let a=await fetch("".concat(r,"/crear-orden-venta/update-estado-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e,estado:t})});if(!a.ok){let e=await a.json();throw Error("Error updating estado: ".concat(a.status," - ").concat(JSON.stringify(e)))}return a.json()}async function l(){let e=await fetch("".concat(r,"/get-orden-venta/get-orden-venta-lista-con-envio"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos terminados");let t=await e.json();return console.log("Pedidos Terminados Data:",t.pedidos),t.pedidos}async function c(e){let t=await fetch("".concat(r,"/gestion-envios/post-get-envios-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!t.ok)throw Error("Error fetching pedidos asignados");let a=await t.json();return console.log("Response Data:",a),a.vehiculos}async function d(e){let t=await fetch("".concat(r,"/gestion-envios/post-update-despachar-all-envios-de-vehiculo"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_vehiculo:e})});if(!t.ok){let e=await t.json();throw Error("Error updating estado envio: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}async function u(e,t){let a={id_envio:e,estado:t};console.log(JSON.stringify(a));let o=await fetch("".concat(r,"/gestion-envios/post-update-estado-envio"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok){let e=await o.json();throw Error("Error updating estado envio: ".concat(o.status," - ").concat(JSON.stringify(e)))}return o.json()}async function m(){let e=await fetch("".concat(r,"/crear-orden-venta/get-orden-venta-atrasada"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw console.error("Failed to fetch pedidos reprogramados:",e.statusText),Error("Error fetching pedidos reprogramados");return await e.json()}async function p(){let e=await fetch("".concat(r,"/get-orden-venta/get-orden-venta-en-supervision-por-urgencia"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos urgentes");return(await e.json()).orden_ventas_pendiente_supervision_urgencia}async function h(e){let t={id_orden_venta:e};console.log(JSON.stringify(t));let a=await fetch("".concat(r,"/get-orden-venta/planificador_ordenes_produccion_simulacion_ov"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Error fetching ordenes que se retrasan");return(await a.json()).ordenes_afectadas}async function x(e,t){let a=await fetch("".concat(r,"/get-orden-venta/get-detalle-pedido-por-id-y-cuil"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_orden_venta:t,cuil:e})}),o=await a.json();if(!a.ok)throw Error(o.error||"Error fetching estado del pedido");return o}async function g(e,t,a,o,n){let s=await fetch("".concat(r,"/crear-direccion/post-obtener-direcciones-normalizadas"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_cliente:n,calle:e,numero:t,localidad:a,provincia:o})});if(!s.ok){let e=await s.json();throw Error("Error creating direccion: ".concat(s.status," - ").concat(JSON.stringify(e)))}let i=await s.json();return console.log("Respuesta de crearDireccion en API:",i),i}},44930:(e,t,a)=>{"use strict";a.d(t,{G:()=>n,j:()=>o});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function o(){let e=await fetch("".concat(r,"/all-clients"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).clients}async function n(e){console.log("Actualizar cliente: ",e);let t=await fetch("".concat(r,"/cliente/post-update-cliente"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Error updating cliente");return t.json()}},59601:(e,t,a)=>{Promise.resolve().then(a.bind(a,77901))},71847:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(12115);let o=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...s,width:o,height:o,stroke:a,strokeWidth:l?24*Number(i)/Number(o):i,className:n("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:l,...c}=a;return(0,r.createElement)(i,{ref:s,iconNode:t,className:n("lucide-".concat(o(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...c})});return a.displayName=o(e),a}},77901:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var r=a(95155),o=a(12115),n=a(44930),s=a(71847);let i=(0,s.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var l=a(20562),c=a(8803);let d=(0,s.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),u=(0,s.A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),m=(0,s.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var p=a(28569);let h=e=>{let{cliente:t,onClose:a,onSave:s}=e,[i,l]=(0,o.useState)(t),[c,d]=(0,o.useState)(!1),[u,m]=(0,o.useState)(""),[h,x]=(0,o.useState)(""),[g,f]=(0,o.useState)(""),[b,y]=(0,o.useState)(""),[j,v]=(0,o.useState)(null),[w,N]=(0,o.useState)(!1),[C,_]=(0,o.useState)(""),[k,E]=(0,o.useState)("error"),[S,T]=(0,o.useState)(t.email),[O,z]=(0,o.useState)(t.telefono?t.telefono:""),[A,J]=(0,o.useState)(t.razon_social||"");async function P(){if(null==t.id){_("ID de cliente no disponible. No se pueden guardar los cambios."),E("error"),N(!0);return}let e={id_cliente:t.id,email:S,razon_social:A,telefono:O};try{await (0,n.G)(e),_("Cliente actualizado con \xe9xito."),E("success"),N(!0)}catch(e){console.error("Error updating client:",e),_("Error al actualizar el cliente."),E("error"),N(!0)}}let D=async()=>{if(!u||!h||!g||!b){_("Por favor, completa todos los campos de la nueva direcci\xf3n."),E("error"),N(!0);return}try{let e=await (0,p.Ob)(u,h,g,b,t.id?t.id:0);console.log("Respuesta de crearDireccion:",e),v(e),console.log(e),_("Direccion creada con \xe9xito."),E("success"),N(!0)}catch(e){console.error("Error al crear la direccion:",e),_("Hubo un error al crear la direccion. Por favor, intenta nuevamente."),E("error"),N(!0)}};return(0,r.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:[w&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,r.jsxs)("div",{className:"rounded-lg p-6 shadow-lg w-80 text-center ".concat("error"===k?"bg-red-50 border border-red-300":"bg-green-50 border border-green-300"),children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-2 ".concat("error"===k?"text-red-600":"text-green-600"),children:"error"===k?"Error":"\xc9xito"}),(0,r.jsx)("p",{className:"mb-4 text-sm",children:C}),(0,r.jsx)("button",{onClick:()=>N(!1),className:"px-4 py-2 rounded font-semibold ".concat("error"===k?"bg-red-600 text-white":"bg-green-600 text-white"," hover:opacity-90 transition"),children:"Cerrar"})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-md",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Modificar Cliente"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"nombre_contacto",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),(0,r.jsx)("input",{id:"nombre_contacto",type:"text",name:"nombre_contacto",value:i.nombre_contacto,disabled:!0,placeholder:"Nombre",className:"border p-2 rounded-lg w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"apellido_contacto",className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido"}),(0,r.jsx)("input",{id:"apellido_contacto",type:"text",name:"apellido_contacto",value:i.apellido_contacto,disabled:!0,placeholder:"Apellido",className:"border p-2 rounded-lg w-full"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"cuil",className:"block text-sm font-medium text-gray-700 mb-1",children:"CUIL"}),(0,r.jsx)("input",{id:"cuil",type:"text",name:"cuil",value:i.cuil||"",disabled:!0,placeholder:"CUIL",className:"border p-2 rounded-lg w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,r.jsx)("input",{id:"email",type:"email",name:"email",value:S,onChange:e=>T(e.target.value),placeholder:"Email",className:"border p-2 rounded-lg w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"razon_social",className:"block text-sm font-medium text-gray-700 mb-1",children:"Raz\xf3n Social"}),(0,r.jsx)("input",{id:"razon_social",type:"text",name:"razon_social",value:A,onChange:e=>J(e.target.value),placeholder:"Raz\xf3n Social",className:"border p-2 rounded-lg w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"telefono",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tel\xe9fono"}),(0,r.jsx)("input",{id:"telefono",type:"text",name:"telefono",value:O,onChange:e=>z(e.target.value),placeholder:"Tel\xe9fono",className:"border p-2 rounded-lg w-full"})]}),t.direcciones_asociadas&&t.direcciones_asociadas.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direcciones Asociadas:"}),(0,r.jsx)("ul",{className:"list-disc list-inside text-xs text-gray-600",children:t.direcciones_asociadas.map(e=>(0,r.jsxs)("li",{children:[e.direccion_text," "]},e.id_direccion))})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{className:"bg-primary text-white text-sm rounded p-2 te ",onClick:()=>d(!0),children:"+ Agregar Direccion"})}),(0,r.jsxs)("div",{className:"flex justify-end gap-4 mt-6",children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",onClick:()=>P(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Guardar Cambios"})]})]}),c&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-100 p-4",children:(0,r.jsxs)("div",{className:"border p-4 mt-4 rounded bg-neutral-light",children:[(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Calle"}),(0,r.jsx)("input",{type:"text",value:u,placeholder:"Ingrese la nueva direccion",onChange:e=>m(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Numero"}),(0,r.jsx)("input",{type:"number",placeholder:"Ingrese el numero",value:h,onChange:e=>x(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Ciudad"}),(0,r.jsx)("input",{type:"text",value:g,placeholder:"Ingrese la ciudad",onChange:e=>f(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Provincia"}),(0,r.jsx)("input",{type:"text",value:b,placeholder:"Ingrese la provincia",onChange:e=>y(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsx)("div",{className:"mt-4"}),(0,r.jsx)("button",{onClick:()=>{d(!1)},className:"mt-2 text-sm border rounded bg-error text-white px-4 py-2",children:"Cancelar"}),(0,r.jsxs)("button",{onClick:()=>{d(!1),D()},className:"mt-2 text-sm border rounded bg-success text-white px-4 py-2",children:[" ","Aceptar"]})]})})]})},x=()=>{let[e,t]=(0,o.useState)(""),[a,s]=(0,o.useState)(!0),[p,x]=(0,o.useState)(1),[g,f]=(0,o.useState)(null),[b,y]=(0,o.useState)(!1),[j,v]=(0,o.useState)([]),w=async()=>{try{let e=await (0,n.j)();v(e)}catch(e){console.error("Error fetching clientes:",e)}};(0,o.useEffect)(()=>{w()},[]);let N=(0,o.useMemo)(()=>{let t=j.filter(t=>{var a;return"".concat(t.nombre_contacto," ").concat(t.apellido_contacto).toLowerCase().includes(e.toLowerCase())||(null==(a=t.razon_social)?void 0:a.toLowerCase().includes(e.toLowerCase()))});return t.sort((e,t)=>{let r="".concat(e.nombre_contacto," ").concat(e.apellido_contacto),o="".concat(t.nombre_contacto," ").concat(t.apellido_contacto);return a?r.localeCompare(o):o.localeCompare(r)}),t},[j,e,a]),C=Math.ceil(N.length/10),_=(0,o.useMemo)(()=>{let e=(p-1)*10;return N.slice(e,e+10)},[N,p]);return(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg shadow-lg",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Gesti\xf3n de Clientes"}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[(0,r.jsxs)("div",{className:"relative w-full md:w-1/3",children:[(0,r.jsx)("input",{type:"text",placeholder:"Buscar por nombre o raz\xf3n social...",value:e,onChange:e=>t(e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)(i,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20})]}),(0,r.jsxs)("button",{onClick:()=>s(!a),className:"flex items-center gap-2 px-4 py-2 bg-white border rounded-lg hover:bg-gray-100 transition",children:["Ordenar por Nombre ",a?(0,r.jsx)(l.A,{size:16}):(0,r.jsx)(c.A,{size:16})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4",children:_.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)("p",{className:"font-bold text-lg text-primary",children:e.razon_social}),(0,r.jsx)("p",{className:"font-bold text-md text-primary",children:"".concat(e.nombre_contacto," ").concat(e.apellido_contacto)}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.telefono}),e.cuil&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["CUIL: ",e.cuil]}),e.direcciones_asociadas&&e.direcciones_asociadas.length>0&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Direcciones Asociadas:"}),(0,r.jsx)("ul",{className:"list-disc list-inside text-xs text-gray-600",children:e.direcciones_asociadas.map(e=>(0,r.jsxs)("li",{children:[e.direccion_text," "]},e.id_direccion))})]})]}),(0,r.jsxs)("button",{onClick:()=>{f(e),y(!0),w()},className:"flex items-center gap-2 bg-success text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition text-sm",children:[(0,r.jsx)(d,{size:16}),"Modificar"]})]},e.id))}),C>1&&(0,r.jsxs)("div",{className:"flex justify-center items-center mt-6 gap-2",children:[(0,r.jsx)("button",{onClick:()=>x(e=>Math.max(1,e-1)),disabled:1===p,className:"p-2 rounded-lg bg-white border disabled:opacity-50",children:(0,r.jsx)(u,{size:20})}),(0,r.jsxs)("span",{className:"text-gray-700 font-medium",children:["P\xe1gina ",p," de ",C]}),(0,r.jsx)("button",{onClick:()=>x(e=>Math.min(C,e+1)),disabled:p===C,className:"p-2 rounded-lg bg-white border disabled:opacity-50",children:(0,r.jsx)(m,{size:20})})]}),b&&g&&(0,r.jsx)(h,{cliente:g,onClose:()=>{y(!1),f(null)},onSave:()=>console.log("Saved")})]})},g=()=>(0,r.jsx)("div",{children:(0,r.jsx)(x,{})})}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=59601)),_N_E=e.O()}]);