(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9381],{19819:(e,t,a)=>{"use strict";a.d(t,{default:()=>c});var r=a(95155),o=a(12115),n=a(64954),i=a(44930),s=a(28569);let c=()=>{let[e,t]=(0,o.useState)(!1),[a,c]=(0,o.useState)(""),[d,l]=(0,o.useState)("error"),[u,m]=(0,o.useState)([]),[h,p]=(0,o.useState)([]),[g,x]=(0,o.useState)(null),[f,b]=(0,o.useState)(null),[v,j]=(0,o.useState)(""),[y,N]=(0,o.useState)([]),[w,E]=(0,o.useState)(""),[S,C]=(0,o.useState)(null),[k,_]=(0,o.useState)(""),[T,O]=(0,o.useState)(""),[P,D]=(0,o.useState)(""),[J,F]=(0,o.useState)(""),[z,G]=(0,o.useState)(null),[A,q]=(0,o.useState)(!1),[I,R]=(0,o.useState)(!1),[L,H]=(0,o.useState)(!1),U=new Date,V=new Date(U);V.setDate(U.getDate()+2);let X=V.toISOString().split("T")[0];(0,o.useEffect)(()=>{(async()=>{p(await (0,i.j)())})()},[z]),(0,o.useEffect)(()=>{(async()=>{m(await (0,n.T)())})()},[]);let[$,B]=(0,o.useState)({id:"",cantidad:""});(0,o.useEffect)(()=>{g?(b(h.find(e=>e.id===g)||null),console.log("limpi id direccion"),C(null)):b(null)},[g,h]);let K=()=>{x(null),j(""),N([]),B({id:"",cantidad:""}),E(""),q(!1),C(null)},M=async()=>{if(!k||!T||!P||!J){c("Por favor, completa todos los campos de la nueva direcci\xf3n."),l("error"),t(!0);return}try{let e=await (0,s.Ob)(k,T,P,J,g||0);console.log("Respuesta de crearDireccion:",e),G(e),console.log(e),c("Direccion creada con \xe9xito."),l("success"),t(!0)}catch(e){console.error("Error al crear la direccion:",e),c("Hubo un error al crear la direccion. Por favor, intenta nuevamente."),l("error"),t(!0)}},Q=async()=>{if(!g){c("Debe seleccionar un cliente antes de continuar."),l("error"),t(!0);return}if(!v){c("Debe asignar una fecha de entrega."),l("error"),t(!0);return}if(0===y.length){c("Debe agregar al menos un producto al pedido."),l("error"),t(!0);return}if(A&&!S){c("Selecciona una direcci\xf3n de env\xedo o agrega una nueva."),l("error"),t(!0);return}let e={id_cliente:Number(g),id_vendedor:1,fecha_entrega_solicitada:v,productos:y.map(e=>({id_producto:e.id,cantidad:e.cantidad})),comentario:w,con_envio:A,id_direccion_entrega:S||void 0,prioritario:L};K();try{console.log("Datos del nuevo pedido a enviar:",e),await (0,s.lm)(e),c("Pedido creado con \xe9xito."),l("success"),t(!0)}catch(e){console.error("Error al crear el pedido:",e),c("Hubo un error al crear el pedido. Por favor, intenta nuevamente."),l("error"),t(!0)}};return(0,r.jsxs)("div",{className:"mx-auto max-w-4xl rounded-lg bg-white p-4 shadow-lg md:p-6 relative",children:[e&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,r.jsxs)("div",{className:"rounded-lg p-6 shadow-lg w-80 text-center ".concat("error"===d?"bg-red-50 border border-red-300":"bg-green-50 border border-green-300"),children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-2 ".concat("error"===d?"text-red-600":"text-green-600"),children:"error"===d?"Error":"\xc9xito"}),(0,r.jsx)("p",{className:"mb-4 text-sm",children:a}),(0,r.jsx)("button",{onClick:()=>t(!1),className:"px-4 py-2 rounded font-semibold ".concat("error"===d?"bg-red-600 text-white":"bg-green-600 text-white"," hover:opacity-90 transition"),children:"Cerrar"})]})}),(0,r.jsx)("h2",{className:"mb-6 text-center text-xl font-bold text-primary",children:"Formulario de Nuevo Pedido"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 ",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"cliente",className:"mb-1 block text-sm font-medium",children:"Cliente"}),(0,r.jsxs)("select",{id:"cliente",value:Number(g),onChange:e=>{x(Number(e.target.value)),console.log(g)},className:"w-full rounded border px-3 py-2",children:[(0,r.jsx)("option",{value:0,disabled:!0,children:"Selecciona un cliente"},""),h.map(e=>(0,r.jsx)("option",{value:e.id,children:e.id+" - "+e.nombre_contacto+" "+e.apellido_contacto+" - "+e.razon_social+" - "+e.cuil},e.id))]})]}),(0,r.jsxs)("div",{className:"flex mt-4",children:[(0,r.jsx)("input",{type:"checkbox",checked:A,onChange:e=>q(e.target.checked),className:""}),(0,r.jsx)("label",{className:"ml-2",children:" Requiere Env\xedo"})]}),g&&f&&A&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"cliente",className:"mb-1 block text-sm font-medium",children:"Seleccionar direcci\xf3n"}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("select",{id:"direccion",value:S||"",className:"w-full rounded border px-3 py-2",onChange:e=>{C(Number(e.target.value))},children:[(0,r.jsx)("option",{value:"",disabled:!0,className:"text-black",children:"Selecciona una direcci\xf3n"}),f.direcciones_asociadas&&f.direcciones_asociadas.map(e=>(0,r.jsxs)("option",{value:e.id_direccion,children:[e.id_direccion," - ",e.direccion_text," "]},e.id_direccion))]}),(0,r.jsx)("button",{type:"button",className:"ml-2 text-sm border rounded bg-primary text-white px-4 py-2",onClick:()=>R(!0),children:"+Agregar"})]})]}),I&&A&&(0,r.jsxs)("div",{className:"border p-4 mt-4 rounded bg-neutral-light",children:[(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Calle"}),(0,r.jsx)("input",{type:"text",value:k,placeholder:"Ingrese la nueva direccion",onChange:e=>_(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Numero"}),(0,r.jsx)("input",{type:"number",placeholder:"Ingrese el numero",value:T,onChange:e=>O(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Ciudad"}),(0,r.jsx)("input",{type:"text",value:P,placeholder:"Ingrese la ciudad",onChange:e=>D(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"nuevaDireccion",className:"mb-1 block text-sm font-medium",children:"Provincia"}),(0,r.jsx)("input",{type:"text",value:J,placeholder:"Ingrese la provincia",onChange:e=>F(e.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),(0,r.jsx)("div",{className:"mt-4"}),(0,r.jsx)("button",{onClick:()=>{R(!1)},className:"mt-2 text-sm border rounded bg-error text-white px-4 py-2",children:"Cancelar"}),(0,r.jsxs)("button",{onClick:()=>{C(null),R(!1),M()},className:"mt-2 text-sm border rounded bg-success text-white px-4 py-2",children:[" ","Aceptar"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"fechaEntrega",className:"mb-1 block text-sm font-medium",children:["Fecha de entrega"," ",(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"(Las fecha de entrega debe ser al menos dos semanas despu\xe9s de la fecha actual)"})]}),(0,r.jsx)("input",{id:"fechaEntrega",type:"date",min:X,value:v,onChange:e=>j(e.target.value),className:"w-full rounded border px-3 py-2"})]}),(0,r.jsxs)("div",{className:"flex mt-4",children:[(0,r.jsx)("input",{type:"checkbox",checked:L,onChange:e=>H(e.target.checked),className:" "}),(0,r.jsx)("label",{className:"ml-2",children:" Pedido Prioritario (URGENTE)"})]})]}),(0,r.jsxs)("div",{className:"mt-6 rounded border border-details p-4",children:[(0,r.jsx)("h3",{className:"mb-3 text-lg font-semibold",children:"Agregar Productos"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)("label",{htmlFor:"producto",className:"mb-1 block text-sm font-medium",children:"Producto"}),(0,r.jsxs)("select",{id:"producto",value:$.id,onChange:e=>B({...$,id:e.target.value}),className:"w-full rounded border px-3 py-2",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Selecciona un producto"}),u.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,r.jsxs)("div",{className:"w-full md:w-32",children:[(0,r.jsx)("label",{htmlFor:"cantidad",className:"mb-1 block text-sm font-medium",children:"Cantidad"}),(0,r.jsx)("input",{id:"cantidad",type:"number",min:"1",max:"100",placeholder:"Cant.",value:$.cantidad,onChange:e=>B({...$,cantidad:e.target.value}),className:"w-full rounded border px-3 py-2"})]}),(0,r.jsx)("button",{onClick:()=>{let e=u.find(e=>e.id===Number($.id)),a=Number($.cantidad);if(!e||!a||a<=0){c("Por favor, selecciona un producto y una cantidad v\xe1lida."),l("error"),t(!0);return}if(a>100){c("La cantidad m\xe1xima permitida es 100."),l("error"),t(!0);return}if(y.some(t=>t.id===e.id)){c("El producto ya ha sido agregado. Puedes editarlo o eliminarlo."),l("error"),t(!0);return}N([...y,{id:e.id,nombre:e.nombre,cantidad:a}]),B({id:"",cantidad:""})},className:"rounded bg-primary px-4 py-2 text-white transition hover:opacity-90",children:"+ Agregar"})]})]}),y.length>0&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"Productos en el Pedido"}),(0,r.jsx)("ul",{className:"space-y-2",children:y.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between rounded bg-neutral-light p-2",children:[(0,r.jsxs)("span",{children:[e.nombre," - ",(0,r.jsxs)("strong",{children:["Cantidad: ",e.cantidad]})]}),(0,r.jsx)("button",{onClick:()=>{var t;return t=e.id,void N(y.filter(e=>e.id!==t))},className:"text-sm text-red-600 hover:text-red-800",children:"Eliminar"})]},e.id))})]}),(0,r.jsx)("div",{}),(0,r.jsxs)("div",{className:"mt-6 rounded border border-details p-4",children:[(0,r.jsxs)("label",{htmlFor:"fechaEntrega",className:"mb-1 block text-sm font-medium",children:[" ","Comentario"," "]}),(0,r.jsx)("textarea",{id:"comentario",className:"w-full rounded border px-3 py-2",rows:3,placeholder:"Agrega un comentario adicional (opcional)",value:w,onChange:e=>E(e.target.value)})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-end gap-3",children:[(0,r.jsx)("button",{onClick:K,className:"rounded bg-neutral-dark px-6 py-2 text-white transition hover:opacity-90",children:"Cancelar"}),(0,r.jsx)("button",{onClick:Q,className:"rounded bg-success px-6 py-2 text-white transition hover:opacity-90",children:"Guardar"})]})]})}},28569:(e,t,a)=>{"use strict";a.d(t,{$1:()=>l,A1:()=>g,LP:()=>m,NV:()=>i,OV:()=>s,Ob:()=>x,Sr:()=>u,UE:()=>p,X6:()=>o,dC:()=>c,gq:()=>h,lm:()=>n,s1:()=>d});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function o(){let e=await fetch("".concat(r,"/crear-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");let t=await e.json();return console.log(t),t.data}async function n(e){console.log("Creando nuevo pedido con data:",e);let t=await fetch("".concat(r,"/crear-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log(JSON.stringify(e)),!t.ok){let e=await t.json();throw Error("Error creating pedido: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}async function i(){let e=await fetch("".concat(r,"/get-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching solicitudes de venta");return(await e.json()).orden_ventas_pendientes}async function s(e,t){let a=await fetch("".concat(r,"/crear-orden-venta/update-estado-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e,estado:t})});if(!a.ok){let e=await a.json();throw Error("Error updating estado: ".concat(a.status," - ").concat(JSON.stringify(e)))}return a.json()}async function c(){let e=await fetch("".concat(r,"/get-orden-venta/get-orden-venta-lista-con-envio"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos terminados");let t=await e.json();return console.log("Pedidos Terminados Data:",t.pedidos),t.pedidos}async function d(e){let t=await fetch("".concat(r,"/gestion-envios/post-get-envios-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!t.ok)throw Error("Error fetching pedidos asignados");let a=await t.json();return console.log("Response Data:",a),a.vehiculos}async function l(e){let t=await fetch("".concat(r,"/gestion-envios/post-update-despachar-all-envios-de-vehiculo"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_vehiculo:e})});if(!t.ok){let e=await t.json();throw Error("Error updating estado envio: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}async function u(e,t){let a={id_envio:e,estado:t};console.log(JSON.stringify(a));let o=await fetch("".concat(r,"/gestion-envios/post-update-estado-envio"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok){let e=await o.json();throw Error("Error updating estado envio: ".concat(o.status," - ").concat(JSON.stringify(e)))}return o.json()}async function m(){let e=await fetch("".concat(r,"/crear-orden-venta/get-orden-venta-atrasada"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw console.error("Failed to fetch pedidos reprogramados:",e.statusText),Error("Error fetching pedidos reprogramados");return await e.json()}async function h(){let e=await fetch("".concat(r,"/get-orden-venta/get-orden-venta-en-supervision-por-urgencia"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos urgentes");return(await e.json()).orden_ventas_pendiente_supervision_urgencia}async function p(e){let t={id_orden_venta:e};console.log(JSON.stringify(t));let a=await fetch("".concat(r,"/get-orden-venta/planificador_ordenes_produccion_simulacion_ov"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Error fetching ordenes que se retrasan");return(await a.json()).ordenes_afectadas}async function g(e,t){let a=await fetch("".concat(r,"/get-orden-venta/get-detalle-pedido-por-id-y-cuil"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_orden_venta:t,cuil:e})}),o=await a.json();if(!a.ok)throw Error(o.error||"Error fetching estado del pedido");return o}async function x(e,t,a,o,n){let i=await fetch("".concat(r,"/crear-direccion/post-obtener-direcciones-normalizadas"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_cliente:n,calle:e,numero:t,localidad:a,provincia:o})});if(!i.ok){let e=await i.json();throw Error("Error creating direccion: ".concat(i.status," - ").concat(JSON.stringify(e)))}let s=await i.json();return console.log("Respuesta de crearDireccion en API:",s),s}},44930:(e,t,a)=>{"use strict";a.d(t,{G:()=>n,j:()=>o});let r="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function o(){let e=await fetch("".concat(r,"/all-clients"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).clients}async function n(e){console.log("Actualizar cliente: ",e);let t=await fetch("".concat(r,"/cliente/post-update-cliente"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Error updating cliente");return t.json()}},64954:(e,t,a)=>{"use strict";async function r(){let e=await fetch("".concat("https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd","/productos"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).productos}a.d(t,{T:()=>r})},97653:(e,t,a)=>{Promise.resolve().then(a.bind(a,19819))}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=97653)),_N_E=e.O()}]);