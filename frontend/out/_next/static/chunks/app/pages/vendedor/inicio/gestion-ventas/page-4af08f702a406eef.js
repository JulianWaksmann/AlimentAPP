(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8759],{5055:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var o=a(95155),n=a(12115),i=a(28569),r=a(44930);let s={confirmada:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",cancelada:"bg-red-100 text-red-700",entregada:"bg-blue-100 text-blue-700",pendiente_supervision:"bg-orange-100 text-orange-700",despachado:"bg-purple-100 text-purple-700",asignada_para_envio:"bg-indigo-100 text-indigo-700",lista:"bg-teal-100 text-teal-700"},d=[{value:"idPedido",label:"ID Pedido"},{value:"estado",label:"Estado"},{value:"fechaEntrega",label:"Fecha de Entrega"},{value:"fechaPedido",label:"Fecha de Pedido"},{value:"idCliente",label:"Cliente"}];function c(e){let{pedidos:t}=e,[a,i]=(0,n.useState)([]),[c,l]=(0,n.useState)(""),[p,h]=(0,n.useState)(""),[u,f]=(0,n.useState)("idPedido"),[g,m]=(0,n.useState)(!1),x=(0,n.useMemo)(()=>t.filter(e=>{let t=!c||String(e.idCliente)===c,a=!p||e.estado===p;return t&&a}),[t,c,p]),j=(0,n.useMemo)(()=>{let e=[...x];return e.sort((e,t)=>{let a=e[u],o=t[u];return("idPedido"===u&&(a=Number(a),o=Number(o)),("fechaEntrega"===u||"fechaPedido"===u)&&(a=new Date(a).getTime(),o=new Date(o).getTime()),"number"==typeof a&&"number"==typeof o)?g?a-o:o-a:g?String(a).localeCompare(String(o)):String(o).localeCompare(String(a))}),e},[x,u,g]);return(0,n.useEffect)(()=>{(async()=>{i(await (0,r.j)())})()},[]),(0,o.jsxs)("div",{className:"overflow-x-auto rounded-lg shadow-lg bg-white p-4",children:[(0,o.jsx)("h2",{className:"text-xl font-bold mb-4 text-primary",children:"Pedidos de Venta"}),(0,o.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-2",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("label",{htmlFor:"ordenar",className:"text-sm font-medium",children:"Ordenar por:"}),(0,o.jsx)("select",{id:"ordenar",value:u,onChange:e=>f(e.target.value),className:"border rounded px-2 py-1 text-sm",children:d.map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,o.jsx)("button",{className:" px-2 py-1 rounded bg-neutral-light text-xs",onClick:()=>m(e=>!e),title:"Invertir orden",children:g?"Ascendente ↑":"Descendente ↓"})]}),(0,o.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-2 w-full",children:[(0,o.jsx)("label",{htmlFor:"filtrar",className:"text-sm font-medium",children:"Filtros:"}),(0,o.jsxs)("select",{id:"cliente",value:c,onChange:e=>l(e.target.value),className:"w-full rounded border px-3 py-2",children:[(0,o.jsx)("option",{value:"",children:"Todos los clientes"}),a.map(e=>(0,o.jsx)("option",{value:String(e.id),children:e.id+" - "+e.nombre_contacto+" "+e.apellido_contacto},e.id))]}),(0,o.jsxs)("select",{id:"estado",value:p,onChange:e=>h(e.target.value),className:"w-full rounded border px-3 py-2",children:[(0,o.jsx)("option",{value:"",children:"Todos los estados"}),(0,o.jsx)("option",{value:"confirmada",children:"Confirmada"}),(0,o.jsx)("option",{value:"pendiente_supervision",children:"Pendiente de aprobaci\xf3n"}),(0,o.jsx)("option",{value:"lista",children:"Pedidos Terminados"}),(0,o.jsx)("option",{value:"asignada_para_Envio",children:"Pedidos Listos para envio"}),(0,o.jsx)("option",{value:"despachado",children:"Pedidos Despachados"}),(0,o.jsx)("option",{value:"entregada",children:"Entregada"})]})]})]}),(0,o.jsx)("div",{className:" mt-6 space-y-4",children:j.map(e=>(0,o.jsxs)("div",{className:"rounded-lg border p-3 shadow-sm bg-gray-50",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,o.jsxs)("span",{className:"font-bold text-primary",children:["Pedido #",e.idPedido]}),(0,o.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat(s[e.estado]||"bg-gray-200 text-gray-700"),children:e.estado.charAt(0).toUpperCase()+e.estado.slice(1).replaceAll("_"," ")})]}),(0,o.jsxs)("div",{className:"mb-1 text-sm",children:[(0,o.jsxs)("span",{className:"font-semibold",children:["Cliente ",e.idCliente," :"]})," ",e.nombreCliente," ",e.apellidoCliente]}),(0,o.jsxs)("div",{className:"mb-1 text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Fecha Pedido:"})," ",e.fechaPedido&&new Date(e.fechaPedido).getTime()>0?new Date(e.fechaPedido).toLocaleDateString():"-"]}),(0,o.jsxs)("div",{className:"mb-1 text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Fecha Solicitada:"})," ",e.fechaSolicitada&&new Date(e.fechaSolicitada).getTime()>0?new Date(e.fechaSolicitada).toLocaleDateString():"-"]}),(0,o.jsxs)("div",{className:"mb-1 text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Fecha Entrega:"})," ",e.fechaEntrega&&new Date(e.fechaEntrega).getTime()>0?new Date(e.fechaEntrega).toLocaleDateString():"-"]}),(0,o.jsx)("div",{className:"mb-1 text-sm font-semibold",children:"Productos:"}),(0,o.jsx)("ul",{className:"list-disc pl-5 text-sm",children:e.productos.map(t=>(0,o.jsxs)("li",{children:[t.nombre," ",(0,o.jsxs)("span",{className:"text-xs text-gray-500",children:["x",t.cantidad]})]},"".concat(e.idPedido,"-").concat(t.idProducto)))}),(0,o.jsxs)("div",{className:"mt-2 text-sm",children:[(0,o.jsx)("span",{className:"font-semibold",children:"Valor Total:"})," $",e.valorPedido]})]},e.idPedido))})]})}let l=()=>{let[e,t]=(0,n.useState)([]);return(0,n.useEffect)(()=>{!async function(){let e=await (0,i.X6)();t(e),console.log(e)}()},[]),(0,o.jsx)("div",{className:"min-h-screen bg-neutral-light p-6 space-y-6",children:(0,o.jsx)(c,{pedidos:e})})}},28569:(e,t,a)=>{"use strict";a.d(t,{$1:()=>l,A1:()=>g,LP:()=>h,NV:()=>r,OV:()=>s,Ob:()=>m,Sr:()=>p,UE:()=>f,X6:()=>n,dC:()=>d,gq:()=>u,lm:()=>i,s1:()=>c});let o="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function n(){let e=await fetch("".concat(o,"/crear-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");let t=await e.json();return console.log(t),t.data}async function i(e){console.log("Creando nuevo pedido con data:",e);let t=await fetch("".concat(o,"/crear-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log(JSON.stringify(e)),!t.ok){let e=await t.json();throw Error("Error creating pedido: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}async function r(){let e=await fetch("".concat(o,"/get-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching solicitudes de venta");return(await e.json()).orden_ventas_pendientes}async function s(e,t){let a=await fetch("".concat(o,"/crear-orden-venta/update-estado-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e,estado:t})});if(!a.ok){let e=await a.json();throw Error("Error updating estado: ".concat(a.status," - ").concat(JSON.stringify(e)))}return a.json()}async function d(){let e=await fetch("".concat(o,"/get-orden-venta/get-orden-venta-lista-con-envio"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos terminados");let t=await e.json();return console.log("Pedidos Terminados Data:",t.pedidos),t.pedidos}async function c(e){let t=await fetch("".concat(o,"/gestion-envios/post-get-envios-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!t.ok)throw Error("Error fetching pedidos asignados");let a=await t.json();return console.log("Response Data:",a),a.vehiculos}async function l(e){let t=await fetch("".concat(o,"/gestion-envios/post-update-despachar-all-envios-de-vehiculo"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_vehiculo:e})});if(!t.ok){let e=await t.json();throw Error("Error updating estado envio: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}async function p(e,t){let a={id_envio:e,estado:t};console.log(JSON.stringify(a));let n=await fetch("".concat(o,"/gestion-envios/post-update-estado-envio"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){let e=await n.json();throw Error("Error updating estado envio: ".concat(n.status," - ").concat(JSON.stringify(e)))}return n.json()}async function h(){let e=await fetch("".concat(o,"/crear-orden-venta/get-orden-venta-atrasada"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw console.error("Failed to fetch pedidos reprogramados:",e.statusText),Error("Error fetching pedidos reprogramados");return await e.json()}async function u(){let e=await fetch("".concat(o,"/get-orden-venta/get-orden-venta-en-supervision-por-urgencia"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching pedidos urgentes");return(await e.json()).orden_ventas_pendiente_supervision_urgencia}async function f(e){let t={id_orden_venta:e};console.log(JSON.stringify(t));let a=await fetch("".concat(o,"/get-orden-venta/planificador_ordenes_produccion_simulacion_ov"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Error fetching ordenes que se retrasan");return(await a.json()).ordenes_afectadas}async function g(e,t){let a=await fetch("".concat(o,"/get-orden-venta/get-detalle-pedido-por-id-y-cuil"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_orden_venta:t,cuil:e})}),n=await a.json();if(!a.ok)throw Error(n.error||"Error fetching estado del pedido");return n}async function m(e,t,a,n,i){let r=await fetch("".concat(o,"/crear-direccion/post-obtener-direcciones-normalizadas"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_cliente:i,calle:e,numero:t,localidad:a,provincia:n})});if(!r.ok){let e=await r.json();throw Error("Error creating direccion: ".concat(r.status," - ").concat(JSON.stringify(e)))}let s=await r.json();return console.log("Respuesta de crearDireccion en API:",s),s}},44930:(e,t,a)=>{"use strict";a.d(t,{G:()=>i,j:()=>n});let o="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function n(){let e=await fetch("".concat(o,"/all-clients"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).clients}async function i(e){console.log("Actualizar cliente: ",e);let t=await fetch("".concat(o,"/cliente/post-update-cliente"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Error updating cliente");return t.json()}},76663:(e,t,a)=>{Promise.resolve().then(a.bind(a,5055))}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=76663)),_N_E=e.O()}]);