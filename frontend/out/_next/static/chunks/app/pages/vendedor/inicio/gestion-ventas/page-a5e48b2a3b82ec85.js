(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{4930:(e,t,a)=>{"use strict";async function n(){let e=await fetch("".concat("https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd","/all-clients"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).clients}a.d(t,{j:()=>n})},5055:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(5155),s=a(2115),o=a(8569),l=a(4930);let d={confirmada:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",cancelada:"bg-red-100 text-red-700",entregada:"bg-blue-100 text-blue-700"},r=[{value:"idPedido",label:"ID Pedido"},{value:"estado",label:"Estado"},{value:"fechaEntrega",label:"Fecha de Entrega"},{value:"fechaPedido",label:"Fecha de Pedido"},{value:"idCliente",label:"Cliente"}];function i(e){let{pedidos:t}=e,[a,o]=(0,s.useState)([]),[i,c]=(0,s.useState)(""),[m,h]=(0,s.useState)(""),[u,p]=(0,s.useState)("idPedido"),[x,f]=(0,s.useState)(!1),g=(0,s.useMemo)(()=>t.filter(e=>{let t=!i||String(e.idCliente)===i,a=!m||e.estado===m;return t&&a}),[t,i,m]),j=(0,s.useMemo)(()=>{let e=[...g];return e.sort((e,t)=>{let a=e[u],n=t[u];return("idPedido"===u&&(a=Number(a),n=Number(n)),("fechaEntrega"===u||"fechaPedido"===u)&&(a=new Date(a).getTime(),n=new Date(n).getTime()),"number"==typeof a&&"number"==typeof n)?x?a-n:n-a:x?String(a).localeCompare(String(n)):String(n).localeCompare(String(a))}),e},[g,u,x]);return(0,s.useEffect)(()=>{(async()=>{o(await (0,l.j)())})()},[]),(0,n.jsxs)("div",{className:"overflow-x-auto rounded-lg shadow-lg bg-white p-4",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4 text-primary",children:"Pedidos de Venta"}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{htmlFor:"ordenar",className:"text-sm font-medium",children:"Ordenar por:"}),(0,n.jsx)("select",{id:"ordenar",value:u,onChange:e=>p(e.target.value),className:"border rounded px-2 py-1 text-sm",children:r.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,n.jsx)("button",{className:" px-2 py-1 rounded bg-neutral-light text-xs",onClick:()=>f(e=>!e),title:"Invertir orden",children:x?"Ascendente ↑":"Descendente ↓"})]}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-2 w-full",children:[(0,n.jsx)("label",{htmlFor:"filtrar",className:"text-sm font-medium",children:"Filtros:"}),(0,n.jsxs)("select",{id:"cliente",value:i,onChange:e=>c(e.target.value),className:"w-full rounded border px-3 py-2",children:[(0,n.jsx)("option",{value:"",children:"Todos los clientes"}),a.map(e=>(0,n.jsx)("option",{value:String(e.id),children:e.id+" - "+e.nombre_contacto+" "+e.apellido_contacto},e.id))]}),(0,n.jsxs)("select",{id:"estado",value:m,onChange:e=>h(e.target.value),className:"w-full rounded border px-3 py-2",children:[(0,n.jsx)("option",{value:"",children:"Todos los estados"}),(0,n.jsx)("option",{value:"pendiente",children:"Pendiente"}),(0,n.jsx)("option",{value:"confirmada",children:"Confirmada"}),(0,n.jsx)("option",{value:"cancelada",children:"Cancelada"}),(0,n.jsx)("option",{value:"entregada",children:"Entregada"})]})]})]}),(0,n.jsx)("div",{className:" mt-6 space-y-4",children:j.map(e=>(0,n.jsxs)("div",{className:"rounded-lg border p-3 shadow-sm bg-gray-50",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsxs)("span",{className:"font-bold text-primary",children:["Pedido #",e.idPedido]}),(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat(d[e.estado]||"bg-gray-200 text-gray-700"),children:e.estado.charAt(0).toUpperCase()+e.estado.slice(1)})]}),(0,n.jsxs)("div",{className:"mb-1 text-sm",children:[(0,n.jsxs)("span",{className:"font-semibold",children:["Cliente ",e.idCliente," :"]})," ",e.nombreCliente," ",e.apellidoCliente]}),(0,n.jsxs)("div",{className:"mb-1 text-sm",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Fecha Pedido:"})," ",new Date(e.fechaPedido).toLocaleDateString()]}),(0,n.jsxs)("div",{className:"mb-1 text-sm",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Fecha Solicitada:"})," ",new Date(e.fechaSolicitada).toLocaleDateString()]}),(0,n.jsxs)("div",{className:"mb-1 text-sm",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Fecha Entrega:"})," ",new Date(e.fechaEntrega).toLocaleDateString()]}),(0,n.jsx)("div",{className:"mb-1 text-sm font-semibold",children:"Productos:"}),(0,n.jsx)("ul",{className:"list-disc pl-5 text-sm",children:e.productos.map(t=>(0,n.jsxs)("li",{children:[t.nombre," ",(0,n.jsxs)("span",{className:"text-xs text-gray-500",children:["x",t.cantidad]})]},"".concat(e.idPedido,"-").concat(t.idProducto)))}),(0,n.jsxs)("div",{className:"mt-2 text-sm",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Valor Total:"})," $",e.valorPedido]})]},e.idPedido))})]})}let c=()=>{let[e,t]=(0,s.useState)([]);return(0,s.useEffect)(()=>{!async function(){t(await (0,o.X6)())}()},[]),(0,n.jsx)("div",{className:"min-h-screen bg-neutral-light p-6 space-y-6",children:(0,n.jsx)(i,{pedidos:e})})}},6663:(e,t,a)=>{Promise.resolve().then(a.bind(a,5055))},8569:(e,t,a)=>{"use strict";a.d(t,{NV:()=>l,OV:()=>d,X6:()=>s,lm:()=>o});let n="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function s(){let e=await fetch("".concat(n,"/crear-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching productos");return(await e.json()).data}async function o(e){console.log("Creando nuevo pedido con data:",e);let t=await fetch("".concat(n,"/crear-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log(JSON.stringify(e)),!t.ok){let e=await t.json();throw Error("Error creating pedido: ".concat(t.status," - ").concat(JSON.stringify(e)))}return t.json()}async function l(){let e=await fetch("".concat(n,"/get-orden-venta"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error fetching solicitudes de venta");return(await e.json()).orden_ventas_pendientes}async function d(e,t){let a=await fetch("".concat(n,"/crear-orden-venta/update-estado-orden-venta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_pedido:e,estado:t})});if(!a.ok){let e=await a.json();throw Error("Error updating estado: ".concat(a.status," - ").concat(JSON.stringify(e)))}return a.json()}}},e=>{e.O(0,[441,255,358],()=>e(e.s=6663)),_N_E=e.O()}]);