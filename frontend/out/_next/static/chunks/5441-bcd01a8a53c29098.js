"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5441],{11930:(e,a,t)=>{t.d(a,{A:()=>d});var n=t(95155),r=t(12115),s=t(96440);let i=e=>e?new Date(e).toLocaleString():"—";function d(e){let{tandas:a,className:t,estado:d}=e,[o,l]=(0,r.useState)({}),[u,m]=(0,r.useState)({}),[p,x]=(0,r.useState)({}),[h,_]=(0,r.useState)(a||[]),[g,j]=(0,r.useState)(!1),[f,y]=(0,r.useState)(""),[v,N]=(0,r.useState)(""),[b,w]=(0,r.useState)(null),[E,C]=(0,r.useState)(a||[]),k=new Date;(0,r.useEffect)(()=>{_(a||[])},[a]);let S=(e,a,t)=>(N(e),y(a),j(!0),(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{onClick:()=>{t&&t(),j(!1)},children:"Confirm"}),(0,n.jsx)("button",{onClick:()=>j(!1),children:"Cancel"})]})),O=()=>{_(a||[])},T=(0,r.useCallback)(async()=>{try{let e=await (0,s.Ec)(d);C(e)}catch(e){console.error("Error fetching tandas:",e)}},[d]);(0,r.useEffect)(()=>{T()},[T]);let P=async()=>{var e,a;if(null===b)return;let t=Array.from(new Set((null!=(a=null==(e=h.find(e=>e.id_linea_produccion===b))?void 0:e.tandas_de_produccion)?a:[]).map(e=>e.id_tanda_produccion).filter(e=>"number"==typeof e&&!isNaN(e))));if(0===t.length)return void S("Error","No se encontraron ids de tanda v\xe1lidos.");x(e=>({...e,[b]:!0}));try{await (0,s.w_)(t,d),_(e=>e.map(e=>{var a;if(e.id_linea_produccion!==b)return e;let n=(null!=(a=e.tandas_de_produccion)?a:[]).map(e=>t.includes(e.id_tanda_produccion)?{...e,estado_tanda_produccion:d}:e);return{...e,tandas_de_produccion:n}})),S("\xc9xito","Tandas actualizadas correctamente.",O)}catch(e){console.error(e),S("Error","Error al actualizar las tandas. Reintenta.")}finally{x(e=>({...e,[b]:!1})),w(null)}};return h&&0!==h.length?(0,n.jsxs)("div",{className:"space-y-4 p-4 ".concat(null!=t?t:""),children:[h.map((e,a)=>{var t,r,s;let d=null!=(r=e.id_linea_produccion)?r:a,c=null!=(s=e.tandas_de_produccion)?s:[];return(0,n.jsxs)("article",{className:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200",children:[(0,n.jsxs)("header",{className:"flex items-center justify-between p-3 sm:p-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h3",{className:"text-base font-semibold text-gray-800",children:["L\xednea de Producci\xf3n #",d," "]}),e.nombre_linea_produccion?(0,n.jsxs)("span",{className:"text-sm text-gray-500",children:["\xb7 ",e.nombre_linea_produccion]}):null,c.map(e=>{var a,t,r;return(0,n.jsx)("div",{className:"text-sm text-gray-500",children:(0,n.jsxs)("div",{children:["Orden #",e.id_orden_produccion," - ",null!=(t=e.nombre_producto)?t:"Producto #".concat(null!=(a=e.id_producto)?a:"—")," \xb7 ",null!=(r=e.cantidad_kg_tanda)?r:"—"," kg"]})},e.id_orden_produccion)})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>l(e=>({...e,[d]:!e[d]})),"aria-expanded":!!o[d],className:"text-sm px-3 py-1 rounded-md bg-primary/10 text-primary hover:bg-primary/20",children:o[d]?"Ocultar":"Ver"}),(0,n.jsx)("button",{onClick:()=>((e,a)=>{var t;let n=null==(t=a[0])?void 0:t.estado_tanda_produccion,r="\xbfSeguro que quer\xe9s ".concat(("planificada"===n?"Poner en producci\xf3n":"Finalizar Tanda").toLowerCase()," todas las \xf3rdenes de esta l\xednea?");w(e),S("Confirmaci\xf3n",r)})(d,c),disabled:!!p[d],className:"text-sm px-3 py-1 rounded-md bg-amber-600 text-white hover:opacity-90 disabled:opacity-50",children:p[d]?"Enviando...":(null==(t=c[0])?void 0:t.estado_tanda_produccion)==="planificada"?"Poner en producci\xf3n":"Finalizar Tanda"})]})]}),o[d]&&(0,n.jsxs)("div",{className:"divide-y",children:[c.map(e=>{var a,t,r,s,d,c,o,l,p,x,h,_,g;let j=null!=(t=e.id_orden_produccion)?t:Math.random();return(0,n.jsxs)("div",{className:"p-3 sm:p-4",children:[(0,n.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:null!=(s=e.nombre_producto)?s:"Producto #".concat(null!=(r=e.id_producto)?r:"—")}),(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:["Cliente: ",null!=(d=e.nombre_cliente)?d:"—"," ",null!=(c=e.apellido_cliente)?c:""]})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[null!=(o=e.cantidad_kg_tanda)?o:"—"," kg"]}),(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:["Sec: ",null!=(l=e.secuencia_en_linea)?l:"—"]})]})]}),(0,n.jsxs)("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:[(0,n.jsxs)("div",{children:["Fecha creaci\xf3n de orden de producci\xf3n: ",i(e.fecha_creacion_orden_produccion)]}),(0,n.jsxs)("div",{children:["Fecha de entrega solicitada: ",i(e.fecha_entrega_solicitada_orden_venta)]}),(0,n.jsxs)("div",{className:"mt-1",children:["Estado tanda:"," ",(0,n.jsx)("span",{className:"font-medium ".concat(k>new Date(null!=(p=e.fecha_entrega_solicitada_orden_venta)?p:"")?"text-red-600":"text-green-600"),children:k>new Date(null!=(x=e.fecha_entrega_solicitada_orden_venta)?x:"")?"Retrasada":"A tiempo"})]})]})]})}),(0,n.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,n.jsx)("button",{onClick:()=>m(e=>({...e,[j]:!e[j]})),className:"text-sm px-3 py-1 rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200",children:u[j]?"Ocultar detalle":"Ver detalle"})}),u[j]&&(0,n.jsxs)("div",{className:"mt-3 bg-gray-50 p-3 rounded-md text-sm text-gray-700",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Id Orden:"})," ",e.id_orden_produccion]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Cantidad producto:"})," ",null!=(h=e.cantidad_producto)?h:"—"," bultos"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Fecha entrega solicitada:"})," ",i(e.fecha_entrega_solicitada_orden_venta)]})]}),(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsxs)("details",{className:"bg-white border rounded-md",children:[(0,n.jsxs)("summary",{className:"px-3 py-2 cursor-pointer flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Materias primas requeridas"}),(0,n.jsxs)("span",{className:"text-xs text-gray-500",children:[null!=(_=null==(a=e.materias_primas_requeridas)?void 0:a.length)?_:0," items"]})]}),(0,n.jsxs)("div",{className:"p-3 space-y-2",children:[(null!=(g=e.materias_primas_requeridas)?g:[]).map(e=>{var a,t;return(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:e.nombre_materia_prima}),(0,n.jsx)("div",{className:"text-xs text-gray-500",children:e.codigo_lote})]}),(0,n.jsxs)("div",{className:"text-right text-sm text-gray-700",children:[e.cantidad_materia_prima," ",null!=(a=e.unidad_medida_materia_prima)?a:""]})]},null!=(t=e.id_lote_materia_prima)?t:e.codigo_lote)}),(!e.materias_primas_requeridas||0===e.materias_primas_requeridas.length)&&(0,n.jsx)("div",{className:"text-xs text-gray-500",children:"No hay materias primas asignadas"})]})]})})]})]},j)}),0===c.length&&(0,n.jsx)("div",{className:"p-4 text-center text-sm text-gray-500",children:"No hay \xf3rdenes en esta tanda"})]})]},d)}),(0,n.jsxs)(c,{visible:g,onClose:()=>j(!1),title:v,children:[(0,n.jsx)("p",{children:f}),(0,n.jsx)("button",{onClick:P,className:"mt-4 px-4 py-2 bg-green-600 text-white rounded",children:"Confirmar"})]})]}):(0,n.jsx)("div",{className:"p-4 text-center text-sm text-gray-500",children:"No hay tandas para mostrar"})}let c=e=>{let{visible:a,onClose:t,title:r,children:s}=e;return a?(0,n.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold mb-4",children:r}),(0,n.jsx)("div",{children:s}),(0,n.jsx)("button",{onClick:t,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:"Cerrar"})]})}):null}},51730:(e,a,t)=>{t.d(a,{A:()=>r});var n=t(95155);t(12115);let r=()=>(0,n.jsxs)("header",{className:"bg-gradient-primary text-white py-3 text-center",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold",children:"CORE."}),(0,n.jsx)("h4",{children:"Gestion de Empresas"})]})},96440:(e,a,t)=>{t.d(a,{Ec:()=>r,N0:()=>i,sI:()=>d,tv:()=>c,w_:()=>s});let n="https://eldzogehdj.execute-api.us-east-1.amazonaws.com/prd";async function r(e){let a=await fetch("".concat(n,"/tanda-produccion/post-obtener-tanda-produccion-por-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})});if(!a.ok)throw Error("Error fetching tandas sugeridas");let t=await a.json();return console.log(t),t.lineas_produccion}async function s(e,a){if(console.log("actualizar ot "+e+" a estado: "+a),console.log("actualizar ot "+e+" a estado: "+a),!(await fetch("".concat(n,"/tanda-produccion/post-update-tandas-produccion-estado"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_tandas:e,estado:a})})).ok)throw Error("Error updating tanda produccion")}async function i(){let e=await fetch("".concat(n,"/tanda-produccion/get-all-ordenes-produccion-aceptadas-por-linea-produccion"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error generating tanda");let a=await e.json();return console.log(a),a.lineas_produccion}async function d(e){console.log("Crear Tanda Produccion Manual: ",JSON.stringify({id_linea_produccion:e.id_linea_produccion,ordenes_produccion:e.ordenes_produccion}));let a=await fetch("".concat(n,"/tanda-produccion/post-crear-tandas-produccion-manual"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw console.log("Error creating tanda produccion manual:",e),Error(e.error||"Error creating tanda produccion manual")}return a.json()}async function c(){let e=await fetch("".concat(n,"/tanda-produccion/get-datos-para-planificacion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!e.ok){let a=await e.json();throw console.log("Error fetching planificacion data:",a),Error(a.error||"Error fetching planificacion data")}return e.json()}}}]);